<!DOCTYPE html>
<html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="flattr:id" content="e7nqg5"> <title>ç®—æ³•ç«èµ›ç®€å•æ•°è®ºçŸ¥è¯†(ä¸€) | Mooyyu Crab.â€™s Blog</title> <meta name="generator" content="Jekyll v3.9.0"> <meta property="og:title" content="ç®—æ³•ç«èµ›ç®€å•æ•°è®ºçŸ¥è¯†(ä¸€)"> <meta name="author" content="mooyyu"> <meta property="og:locale" content="en_US"> <meta name="description" content="ä»ç¼–ç¨‹çš„è§’åº¦ç®€å•äº†è§£æ•°è®ºåŸç†å¹¶ä»¥ä»£ç å®ç°ç³»åˆ—ä¸€"> <meta property="og:description" content="ä»ç¼–ç¨‹çš„è§’åº¦ç®€å•äº†è§£æ•°è®ºåŸç†å¹¶ä»¥ä»£ç å®ç°ç³»åˆ—ä¸€"> <link rel="canonical" href="https://mooyyu.github.io/docs/algorithm/Math-1.html"> <meta property="og:url" content="https://mooyyu.github.io/docs/algorithm/Math-1.html"> <meta property="og:site_name" content="Mooyyu Crab.â€™s Blog"> <meta property="og:type" content="article"> <meta property="article:published_time" content="2020-03-07T00:00:00+00:00"> <meta name="twitter:card" content="summary"> <meta property="twitter:title" content="ç®—æ³•ç«èµ›ç®€å•æ•°è®ºçŸ¥è¯†(ä¸€)"> <meta name="google-site-verification" content="0LZg36yiItnOtvXj-x8GPjsLmWZk9ujUR7nl6SRb28g"> <meta name="baidu-site-verification" content="code-0BzdQrWuUd"> <script type="application/ld+json">
{"url":"https://mooyyu.github.io/docs/algorithm/Math-1.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://mooyyu.github.io/assets/images/logo/mooyyu/m.png"},"name":"mooyyu"},"author":{"@type":"Person","name":"mooyyu"},"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://mooyyu.github.io/docs/algorithm/Math-1.html"},"description":"ä»ç¼–ç¨‹çš„è§’åº¦ç®€å•äº†è§£æ•°è®ºåŸç†å¹¶ä»¥ä»£ç å®ç°ç³»åˆ—ä¸€","headline":"ç®—æ³•ç«èµ›ç®€å•æ•°è®ºçŸ¥è¯†(ä¸€)","dateModified":"2020-03-07T00:00:00+00:00","datePublished":"2020-03-07T00:00:00+00:00","@context":"https://schema.org"}</script> <link rel="icon" href="/assets/favicon.ico"> <link rel="stylesheet" href="/assets/stylesheets/main.css?v=20210128-1"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script><![endif]--> <script src="/assets/javascript/head.min.js"></script> <script type="text/javascript">

      /**
       * As Github pages do not support https for custom domains
       * this is the current best workaround for #18.
       */
      var domains  = [ 'mooyyu.github.io', 'localhost', '127.0.0.1' ];
      var pathname = location.pathname.replace(/^\/Mooyyu Crab.'s Github Page/, '')
      if (domains.indexOf(window.location.hostname) == -1)
        window.top.location.href = 'https://mooyyu.github.io' + pathname;

      /**
       * Another ugly workaround trying to improve UX reported by #35
       */
      if (location.protocol != 'https:' && window.location.hostname == 'mooyyu.github.io')
        location.href = 'https:' + window.location.href.substring(window.location.protocol.length);

      /**
       * Improves overall speed by loading javascript and css resources in parallel
       * with the main page.
       */
      head.load(
          "/assets/stylesheets/font-awesome.min.css",

          "/assets/javascript/jquery-2.2.1.min.js",
          "/assets/javascript/jquery-ui.min.js",
          "/assets/javascript/bootstrap.min.js",
          "/assets/javascript/tocify.min.js",
          "/assets/javascript/custom.js",

          "/assets/javascript/sheetrock.min.js",
          "/assets/javascript/cookieconsent.min.js",
          "/assets/javascript/pop.min.js"
      );

      head.ready(function() {
        window.cookieconsent_options = {
          "message":"This site use cookies to ensure you get the best experience on the website",
          "dismiss": "Got it!", "learnMore": "More info", "link":"", "theme": "dark-bottom"
        };
        $("body").on('click', '[data-stopPropagation]', function (e) {
          e.stopPropagation();
        });
      });
    </script> </head> <body role="document"> <nav class="navbar navbar-default navbar-fixed-top custom-no-margin"> <div class="container"> <div class="navbar-header"> <a href="/" class="navbar-brand" style="color: slategrey;"> Mooyyu Crab.'s Blog </a> <img id="daynite" src="/assets/images/btn-night.svg" alt="Dark Mode" width="32" height="32"> <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> </div> <div class="navbar-collapse collapse" id="navbar-main"> <ul class="nav navbar-nav"> <li><a href="/whoami/">WHO AM I? </a></li> <li class="dropdown siteindex"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-documentation">Site Index <span class="caret"></span></a> <ul class="dropdown-menu"> <li class="dropdown dropdown-submenu algorithm"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-stoppropagation="true" id="navbar-sub-algorithm">Algorithm</a> <ul class="dropdown-menu"> <li><a href="/meta/algorithm/"> All documents </a></li> <li class="divider"> <li><a href="/docs/algorithm/DP-knapsack.html">åŠ¨æ€è§„åˆ’: èƒŒåŒ…é—®é¢˜ (ä¸€)</a></li> <li><a href="/docs/algorithm/DP-linear.html">åŠ¨æ€è§„åˆ’å…¥é—¨ä¹‹çº¿æ€§æå€¼æ¨¡å‹</a></li> <li><a href="/docs/algorithm/DS-1.html">ç®—æ³•ç«èµ›ç®€å•æ•°æ®ç»“æ„(ä¸€)</a></li> <li><a href="/docs/algorithm/Graph-segment_tree_scan.html">çº¿æ®µæ ‘ä¹‹æ‰«æçº¿æµ…è°ˆ</a></li> <li><a href="/docs/algorithm/Math-1.html">ç®—æ³•ç«èµ›ç®€å•æ•°è®ºçŸ¥è¯†(ä¸€)</a></li> <li><a href="/docs/algorithm/Graph-shortest_path.html">å›¾è®ºæµ…è°ˆä¹‹æœ€çŸ­è·¯</a></li> <li><a href="/docs/algorithm/basic.html">åŸºç¡€ç®—æ³•æ‚è°ˆ</a></li> </ul> </li> <li class="dropdown dropdown-submenu oicode"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-stoppropagation="true" id="navbar-sub-oicode">OI-code</a> <ul class="dropdown-menu"> <li><a href="/meta/oicode/"> All documents </a></li> <li class="divider"> <li><a href="/docs/oicode/B1.html"><strong>B1</strong>: å‰ç¼€å’Œä¸å·®åˆ†</a></li> <li><a href="/docs/oicode/B2.html"><strong>B2</strong>: å¿«é€Ÿç»„åˆ</a></li> <li><a href="/docs/oicode/B3.html"><strong>B3</strong>: äºŒåˆ†æŸ¥æ‰¾</a></li> <li><a href="/docs/oicode/B4-add.html"><strong>B4</strong>: é«˜ç²¾åº¦åŠ æ³•</a></li> <li><a href="/docs/oicode/B4-div.html"><strong>B4</strong>: é«˜ç²¾åº¦é™¤æ³•</a></li> <li><a href="/docs/oicode/B4-multi.html"><strong>B4</strong>: é«˜ç²¾åº¦ä¹˜æ³•</a></li> <li><a href="/docs/oicode/B4-sub.html"><strong>B4</strong>: é«˜ç²¾åº¦å‡æ³•</a></li> <li><a href="/docs/oicode/D1.html"><strong>D1</strong>: å•è°ƒæ ˆ</a></li> <li><a href="/docs/oicode/D2.html"><strong>D2</strong>: å•è°ƒé˜Ÿåˆ—</a></li> <li><a href="/docs/oicode/D3.html"><strong>D3</strong>: Spare Table</a></li> <li><a href="/docs/oicode/D4.html"><strong>D4</strong>: å­—å…¸æ ‘</a></li> <li><a href="/docs/oicode/D5.html"><strong>D5</strong>: å¹¶æŸ¥é›†</a></li> <li><a href="/docs/oicode/D6-rc.html"><strong>D6</strong>: æ ‘çŠ¶æ•°ç»„-é™å®šåŒºé—´è®¡æ•°</a></li> <li><a href="/docs/oicode/D6-surs.html"><strong>D6</strong>: æ ‘çŠ¶æ•°ç»„-å•ç‚¹æ›´æ–°åŒºé—´æ±‚å’Œ</a></li> <li><a href="/docs/oicode/D7-basic.html"><strong>D7</strong>: çº¿æ®µæ ‘-åŸºç¡€</a></li> <li><a href="/docs/oicode/G1.html"><strong>G1</strong>: äºŒåˆ†å›¾-åˆ¤å®š</a></li> <li><a href="/docs/oicode/G2.html"><strong>G2</strong>: äºŒåˆ†å›¾-æœ€å¤§åŒ¹é…</a></li> <li><a href="/docs/oicode/G3.html"><strong>G3</strong>: Astar kçŸ­è·¯ on matrix</a></li> <li><a href="/docs/oicode/G4.html"><strong>G4</strong>: æ‹“æ‰‘æ’åº</a></li> <li><a href="/docs/oicode/G5.html"><strong>G5</strong>: è¿é€šæ— ç¯æ— å‘å›¾çš„é‡å¿ƒ</a></li> <li><a href="/docs/oicode/G6.html"><strong>G6</strong>: MST-Kruskal</a></li> <li><a href="/docs/oicode/G7.html"><strong>G7</strong>: MST-Prim</a></li> <li><a href="/docs/oicode/G8.html"><strong>G8</strong>: ShortestPath-BellmanFord</a></li> <li><a href="/docs/oicode/G9.html"><strong>G9</strong>: ShortestPath-Dijkstra</a></li> <li><a href="/docs/oicode/G9-hopt.html"><strong>G9</strong>: ShortestPath-Dijkstra Heap OPT</a></li> <li><a href="/docs/oicode/G10.html"><strong>G10</strong>: ShortestPath-SPFA</a></li> <li><a href="/docs/oicode/G11.html"><strong>G11</strong>: ShortestPath-Floyd</a></li> <li><a href="/docs/oicode/M1.html"><strong>M1</strong>: å¿«é€Ÿå¹‚ä¸é¾Ÿé€Ÿä¹˜</a></li> <li><a href="/docs/oicode/M2.html"><strong>M2</strong>: æ¬§å‡ é‡Œå¾—-æœ€å¤§å…¬çº¦æ•°</a></li> <li><a href="/docs/oicode/M2-ft.html"><strong>M2</strong>: EXæ¬§å‡ é‡Œå¾—-ç¿¡èœ€å®šç†</a></li> <li><a href="/docs/oicode/M2-lce.html"><strong>M2</strong>: EXæ¬§å‡ é‡Œå¾—-çº¿æ€§åŒä½™æ–¹ç¨‹</a></li> <li><a href="/docs/oicode/M2-mi.html"><strong>M2</strong>: EXæ¬§å‡ é‡Œå¾—-ä¹˜æ³•é€†å…ƒ</a></li> <li><a href="/docs/oicode/M3-flt.html"><strong>M3</strong>: è´¹é©¬å°å®šç†-ä¹˜æ³•é€†å…ƒ</a></li> <li><a href="/docs/oicode/M4.html"><strong>M4</strong>: åˆ†è§£è´¨å› æ•°</a></li> <li><a href="/docs/oicode/M4-euler.html"><strong>M4</strong>: åˆ†è§£è´¨å› æ•°-æ¬§æ‹‰å‡½æ•°</a></li> <li><a href="/docs/oicode/M4-prc.html"><strong>M4</strong>: åˆ†è§£è´¨å› æ•°-å¤šæ•°ä¹˜ç§¯çº¦æ•°è®¡æ•°</a></li> <li><a href="/docs/oicode/M4-prs.html"><strong>M4</strong>: åˆ†è§£è´¨å› æ•°-å¤šæ•°ä¹˜ç§¯çº¦æ•°æ±‚å’Œ</a></li> <li><a href="/docs/oicode/M5.html"><strong>M5</strong>: æ¬§æ‹‰ç­›</a></li> <li><a href="/docs/oicode/M5-ps.html"><strong>M5</strong>: æ¬§æ‹‰ç­›-è´¨æ•°ç­›</a></li> <li><a href="/docs/oicode/M6.html"><strong>M6</strong>: åŸƒæ°ç­›-è´¨æ•°ç­›</a></li> <li><a href="/docs/oicode/M7.html"><strong>M7</strong>: Steinç®—æ³•-æœ€å¤§å…¬çº¦æ•°</a></li> <li><a href="/docs/oicode/M8.html"><strong>M8</strong>: çŸ©é˜µä¹˜æ³•ä¸å¿«é€Ÿå¹‚</a></li> <li><a href="/docs/oicode/O1.html"><strong>O1</strong>: å¿«é€Ÿæ’åº</a></li> <li><a href="/docs/oicode/O2.html"><strong>O2</strong>: å¹¶å½’æ’åº</a></li> <li><a href="/docs/oicode/S1.html"><strong>S1</strong>: KMP</a></li> <li><a href="/docs/oicode/S2.html"><strong>S2</strong>: å­—ç¬¦ä¸²å“ˆå¸Œ</a></li> </ul> </li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-algorithm">ä¼ ç»Ÿç®—æ³• <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="/docs/algorithm/basic">åŸºç¡€ç®—æ³•æ‚è°ˆ</a></li> <li class="divider"> <li><a href="/docs/algorithm/DS-1">ç®—æ³•ç«èµ›ç®€å•æ•°æ®ç»“æ„(ä¸€)</a></li> <li class="divider"> <li><a href="/docs/algorithm/DP-knapsack">åŠ¨æ€è§„åˆ’:èƒŒåŒ…é—®é¢˜(ä¸€)</a></li> <li><a href="/docs/algorithm/DP-linear">åŠ¨æ€è§„åˆ’å…¥é—¨ä¹‹çº¿æ€§æå€¼æ¨¡å‹</a></li> <li class="divider"> <li><a href="/docs/algorithm/Graph-shortest_path">å›¾è®ºæµ…è°ˆä¹‹æœ€çŸ­è·¯</a></li> <li><a href="/docs/algorithm/Graph-segment_tree_scan">çº¿æ®µæ ‘ä¹‹æ‰«æçº¿æµ…è°ˆ</a></li> <li class="divider"> <li><a href="/docs/algorithm/Math-1">ç®—æ³•ç«èµ›ç®€å•æ•°è®ºçŸ¥è¯†(ä¸€)</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-math">C++ç¬”è®° <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a>ğŸ¦‰å³å°†ä¸Šçº¿</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-math">æ•°å­¦ç¬”è®° <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a>ğŸ¦‰å³å°†ä¸Šçº¿</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-ai">AIç¬”è®° <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a>ğŸ¦‰å³å°†ä¸Šçº¿</a></li> </ul> </li> </ul> <ul class="nav navbar-nav navbar-right visible-lg-block"> </ul> </div> </div> </nav> <div class="container" role="main"> <div class="row"> <div class="col-lg-3 col-md-4 visible-lg-block visible-md-block custom-no-padding"> <div class="custom-fixed-sidebar"> <div id="toc"></div> </div> </div> <div class="col-lg-9 col-md-8 custom-bg-white"> <div class="row"> <div class="col-md-12 custom-article"> <p class="text-right pull-right visible-lg-block hidden-print small custom-pt25"> <a href="//github.com/mooyyu" target="_blank" data-toggle="tooltip" data-placement="bottom" title="Visit mooyyu's profile on Github"><img class="avatar avatar-small" alt="mooyyu" width="30" height="30" data-proofer-ignore="true" src="https://avatars3.githubusercontent.com/mooyyu?v=3&s=30" srcset="https://avatars3.githubusercontent.com/mooyyu?v=3&s=30 1x, https://avatars3.githubusercontent.com/mooyyu?v=3&s=60 2x, https://avatars3.githubusercontent.com/mooyyu?v=3&s=90 3x, https://avatars3.githubusercontent.com/mooyyu?v=3&s=120 4x"></a> </p> <h1 class="custom-article-header">ç®—æ³•ç«èµ›ç®€å•æ•°è®ºçŸ¥è¯†(ä¸€)</h1> <p class="text-right pull-right small">07 March 2020</p> <p class="small"> ä»ç¼–ç¨‹çš„è§’åº¦ç®€å•äº†è§£æ•°è®ºåŸç†å¹¶ä»¥ä»£ç å®ç°ç³»åˆ—ä¸€ </p> <p>åœ¨ç®—æ³•ç«èµ›ä¸­å¸¸å¸¸ç”¨åˆ°ä¸€äº›ç®€å•çš„æ•°è®ºçŸ¥è¯†ï¼ŒåŸç†é€šå¸¸å¹¶ä¸å¤æ‚ï¼Œä½†è‹¥æƒ³è¦çµæ´»è¿ç”¨ï¼Œç†è§£å…¶åŸç†ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°ä½¿ç”¨ä»£ç å®ç°åˆ™æ˜¯åŸºç¡€ä¸­çš„åŸºç¡€ã€‚æœ¬æ–‡å¯¹ä¸€äº›åŸç†åšä¸€äº›ç®€å•çš„è¯æ˜ï¼Œå¯¹ç®—æ³•ç»™å‡ºæ ¸å¿ƒå®ç°çš„ä¼ªä»£ç å¹¶ä½¿ç”¨c++ç¤ºèŒƒä»£ç å®ç°ç»†èŠ‚çš„é¿é”™ä¸ä¼˜åŒ–ã€‚</p> <hr> <h2 id="æœ¬æ–‡çš„ä¸»è¦å†…å®¹">æœ¬æ–‡çš„ä¸»è¦å†…å®¹</h2> <ul> <li>ç®—æ•°åŸºæœ¬å®šç† <ul> <li>åˆ†è§£è´¨å› æ•°</li> </ul> </li> <li>çº¦æ•° <ul> <li>è¯•é™¤æ³•æ±‚ä¸€ä¸ªæ•°çš„æ‰€æœ‰çº¦æ•°</li> <li>æœ€å¤§å…¬çº¦æ•° <ul> <li>æ¬§å‡ é‡Œå¾—ç®—æ³•</li> <li>Steinç®—æ³•</li> </ul> </li> <li>çº¦æ•°ä¸ªæ•°</li> <li>çº¦æ•°ä¹‹å’Œ</li> </ul> </li> <li>è´¨æ•° <ul> <li>è¯•é™¤æ³•åˆ¤å®šè´¨æ•°</li> <li>è´¨æ•°è®¡æ•°å‡½æ•°</li> <li>è´¨æ•°ç­› <ul> <li>åŸƒæ°è´¨æ•°ç­›</li> <li>æ¬§æ‹‰è´¨æ•°ç­›</li> </ul> </li> </ul> </li> <li>æ¬§æ‹‰å‡½æ•° <ul> <li>æ¬§æ‹‰å‡½æ•°ç­›</li> </ul> </li> <li>æ¬§æ‹‰å®šç†ä¸è´¹é©¬å°å®šç†</li> <li>è£´èœ€/è´ç¥–å®šç†ä¸æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</li> <li>åŒä½™ <ul> <li>çº¿æ€§åŒä½™æ–¹ç¨‹</li> <li>ä¹˜æ³•é€†å…ƒ</li> </ul> </li> </ul> <h2 id="ç®—æ•°åŸºæœ¬å®šç†">ç®—æ•°åŸºæœ¬å®šç†</h2> <p>ç®—æ•°åŸºæœ¬å®šç†ä¹Ÿå«æ­£æ•´æ•°å”¯ä¸€åˆ†è§£å®šç†ã€‚å¯ä»¥è¯´æ˜¯æ•°è®ºçš„ä¸€å—åŸºçŸ³ï¼Œç”¨å¤„å¾ˆå¹¿æ³›ã€‚</p> <blockquote> <p>ä»»ä½•å¤§äº\(1\)çš„è‡ªç„¶æ•°\(n\)å¯ä»¥è¢«å”¯ä¸€åˆ†è§£ä¸ºè´¨æ•°å¹‚æ¬¡çš„ä¹˜ç§¯ã€‚</p> <p>è¡¨ç¤ºä¸º\(n = \textstyle\prod_{i = 1}^s {p_i}^{k_i} \mid n &gt; 1, n \in \mathbb{N}\)</p> </blockquote> <p>è¿™ä¸ªç­‰å¼å³æ˜¯å¯¹\(n\)çš„è´¨å› æ•°åˆ†è§£ï¼Œå¹¶ä¸”æ»¡è¶³ä»¥ä¸‹æ€§è´¨</p> <ul> <li>è¯¥åˆ†è§£æœ‰åºå”¯ä¸€ï¼Œä»»æ„ä¸€ä¸ªç¡®å®šçš„\(n\)å¯ä»¥å¾—åˆ°ä¸€ä¸ªç¡®å®šçš„è´¨å› æ•°åˆ†è§£ï¼Œä»»æ„ä¸€ç»„åˆ†è§£å¾—åˆ°è´¨å› æ•°å¯ä»¥ç¡®å®šä¸€ä¸ªæ•°</li> <li>\(n\)è‡³å¤šæœ‰ä¸€ä¸ªå¤§äº\(\sqrt n\)çš„è´¨å› å­ï¼Œæ­¤æ€§è´¨å¯ç”¨äºä¼˜åŒ–åˆ†è§£è´¨å› æ•°çš„å®ç°</li> </ul> <h3 id="åˆ†è§£è´¨å› æ•°">åˆ†è§£è´¨å› æ•°</h3> <p>åˆ†è§£è´¨å› æ•°æ˜¯å¯¹ç®—æ•°åŸºæœ¬å®šç†çš„ç›´æ¥è¿ç”¨ã€‚ä¼ªä»£ç å¦‚ä¸‹</p> \[\begin{aligned} &amp;k_{p_i = 2} = log_2 lowbit(n)\newline &amp;cur = \textstyle\frac n{lowbit(n)}\newline &amp;for\quad p_i = 3; p_i \leqslant \lfloor \textstyle\frac{cur}{p_i}\rfloor; p_i = p_i + 2\newline &amp;\hphantom{for\quad}k_i = 0\newline &amp;\hphantom{for\quad}while\quad p_i\mid cur\newline &amp;\hphantom{for\quad while\quad}k_i = k_i + 1\newline &amp;\hphantom{for\quad while\quad}cur = \textstyle\frac{cur}{p_i}\newline &amp;if\quad cur &gt; 1\newline &amp;\hphantom{if\quad}k_{p_i = cur} = 1 \end{aligned}\] <p>ä½¿ç”¨çš„ä¼˜åŒ–</p> <ul> <li>å¯¹å¤§äº\(\sqrt n\)çš„é‚£ä¸€ä¸ªè´¨å› å­åšç‰¹åˆ¤</li> <li>ä½¿ç”¨åŠ¨æ€çš„\(cur\)ä»£æ›¿\(n\)ï¼Œæ¯æ¬¡æ‰¾åˆ°çš„è´¨å› å­éƒ½æ˜¯å½“å‰\(cur\)çš„æœ€å°è´¨å› å­ï¼Œå› ä¸ºä»»æ„ä¸€ä¸ª\(cur\)çš„è´¨å› å­é›†åˆå¯ä»¥åˆ†è§£ä¸º\(cur\)çš„æœ€å°å€¼å› å­\(p_i^{k_i}\)åŠ ä¸Š\(\frac{cur}{p_i^{k_i}}\)çš„è´¨å› å­é›†åˆï¼Œå¹¶ä¸”æŸ¥æ‰¾èŒƒå›´ä¸æ–­ç¼©å°</li> <li>æ˜¯å¶æ•°çš„è´¨æ•°åªæœ‰\(2\)ï¼Œå¯ä»¥ä½¿ç”¨\(lowbit\)<sup id="fnref:lowbit" role="doc-noteref"><a href="#fn:lowbit" class="footnote" rel="footnote">1</a></sup>ç‰¹åˆ¤ï¼Œç„¶ååœ¨å¥‡æ•°ä¸­æŸ¥æ‰¾è´¨å› å­</li> </ul> <p>å…·ä½“å®ç°ä»£ç å¦‚ä¸‹</p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">type</span> <span class="p">&gt;</span>
<span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span> <span class="o">&gt;&amp;</span> <span class="n">pfactor</span><span class="p">(</span><span class="n">type</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">static</span> <span class="kt">int</span> <span class="n">k</span><span class="p">;</span>
	<span class="k">static</span> <span class="n">type</span> <span class="n">cur</span><span class="p">;</span>
	<span class="k">static</span> <span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">pfs</span><span class="p">;</span>
	<span class="n">pfs</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
	<span class="n">k</span> <span class="o">=</span> <span class="n">lowbit</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">k</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;&gt;=</span> <span class="mi">1u</span><span class="p">)</span> <span class="o">++</span><span class="n">pfs</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">cur</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">cur</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">++</span><span class="n">pfs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cur</span> <span class="o">/=</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">cur</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">++</span><span class="n">pfs</span><span class="p">[</span><span class="n">cur</span><span class="p">];</span>
	<span class="k">return</span> <span class="n">pfs</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h2 id="çº¦æ•°">çº¦æ•°</h2> <blockquote> <p>è‹¥\(d\)èƒ½æ•´é™¤\(x\)ï¼Œåˆ™ç§°\(d\)æ˜¯\(x\)çš„ä¸€ä¸ªçº¦æ•°</p> </blockquote> <h3 id="è¯•é™¤æ³•æ±‚ä¸€ä¸ªæ•°çš„æ‰€æœ‰çº¦æ•°">è¯•é™¤æ³•æ±‚ä¸€ä¸ªæ•°çš„æ‰€æœ‰çº¦æ•°</h3> \[\begin{aligned} &amp;for\quad l = 1; r = \textstyle\frac xl, l &lt; r; l = l + 1\newline &amp;\hphantom{for\quad}if\quad l \mid r\newline &amp;\hphantom{for\quad if\quad}get\ l, r\newline &amp;if\quad l \mid x \enspace\&amp;\&amp;\enspace l\ equal\ r\newline &amp;\hphantom{if\quad}get\ \sqrt x \end{aligned}\] <p>ä½¿ç”¨çš„ä¼˜åŒ–</p> <ul> <li>è‹¥\(d\)æ˜¯\(x\)çš„çº¦æ•°ï¼Œåˆ™\(\frac xd\)ä¹Ÿä¸€å®šæ˜¯\(x\)çš„çº¦æ•°</li> </ul> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;&amp;</span> <span class="n">divs</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">static</span> <span class="n">vector</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">ret</span><span class="p">;</span>
	<span class="k">static</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span>
	<span class="n">ret</span><span class="p">.</span><span class="n">clear</span><span class="p">(),</span> <span class="n">ret</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">maxn</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">l</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">l</span><span class="p">);</span> <span class="n">l</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">ret</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
			<span class="n">ret</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="n">ret</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
	<span class="n">sort</span><span class="p">(</span><span class="n">ret</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">ret</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="æœ€å¤§å…¬çº¦æ•°">æœ€å¤§å…¬çº¦æ•°</h3> <blockquote> <p>\(gcd(a, b)\)bè¡¨ç¤º\(a, b\)çš„æœ€å¤§å…¬çº¦æ•°</p> </blockquote> <p>æ»¡è¶³çš„æ€§è´¨å¦‚ä¸‹</p> <ul> <li>\(gcd(ka, kb) = k \times gcd(a, b)\)ï¼Œä»¤\(k = 2\)å¯ä»¥è§£é‡Šä¸¤å¶æ•°çš„æœ€å¤§å…¬çº¦æ•°ä»æ˜¯å¶æ•°</li> <li>è‹¥\(k \nmid b\)ï¼Œåˆ™\(gcd(ka, b) = gcd(a, b)\)</li> </ul> <h4 id="æ¬§å‡ é‡Œå¾—ç®—æ³•">æ¬§å‡ é‡Œå¾—ç®—æ³•</h4> <p>æ¬§å‡ é‡Œå¾—ç®—æ³•å³æˆ‘ä»¬ç†ŸçŸ¥çš„è¾—è½¬ç›¸é™¤æ³• \(gcd(a, b) = \begin{cases} a,&amp;b = 0\newline gcd(b, a\ mod\ b),&amp;b\not = 0 \end{cases}\)</p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">type</span> <span class="p">&gt;</span>
<span class="n">type</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">type</span> <span class="n">a</span><span class="p">,</span> <span class="n">type</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">b</span> <span class="o">?</span> <span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span> <span class="o">:</span> <span class="n">a</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div></div> <h4 id="steinç®—æ³•">Steinç®—æ³•</h4> <p>Steinç®—æ³•å³æ˜¯ä»¥è¾—è½¬ç›¸å‡æ³•ä¸ºåŸºç¡€ï¼Œåˆ©ç”¨ä¸Šæ–‡æåˆ°çš„ä¸¤ä¸ªæ€§è´¨è¿›è¡Œä¼˜åŒ–ï¼Œæ•´ä¸ªç®—æ³•ä»…æ¶‰åŠåˆ°åŠ å‡æ³•å’Œç§»ä½æ“ä½œï¼Œè¯¥ç®—æ³•å¯¹äºå¤§ç´ æ•°å¾ˆæœ‰ä¼˜åŠ¿</p> \[gcd(a, b) = \begin{cases} gcd(\frac a2, \frac b2)\times 2,&amp;2\mid a,\ 2\mid b\newline gcd(\frac a2, b),&amp;2\mid a,\ 2\nmid b\newline gcd(a, \frac b2),&amp;2\nmid a,\ 2\mid b\newline gcd(b, a),&amp;2\nmid a,\ 2\nmid b,\ a &lt; b\newline gcd(\frac{a - b}2, b),&amp;2\nmid a,\ 2\nmid b,\ a \geqslant b\newline a,&amp;b = 0 \end{cases}\] <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">type</span> <span class="p">&gt;</span>
<span class="n">type</span> <span class="nf">stein</span><span class="p">(</span><span class="n">type</span> <span class="n">a</span><span class="p">,</span> <span class="n">type</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="o">~</span><span class="n">a</span> <span class="o">&amp;</span> <span class="mi">1u</span> <span class="o">&amp;&amp;</span> <span class="o">~</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mi">1u</span><span class="p">)</span> <span class="n">a</span> <span class="o">&gt;&gt;=</span> <span class="mi">1u</span><span class="p">,</span> <span class="n">b</span> <span class="o">&gt;&gt;=</span> <span class="mi">1u</span><span class="p">,</span> <span class="o">++</span><span class="n">c</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="o">~</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mi">1u</span><span class="p">)</span> <span class="n">b</span> <span class="o">&gt;&gt;=</span> <span class="mi">1u</span><span class="p">;</span>
	<span class="k">do</span> <span class="p">{</span>
		<span class="k">while</span> <span class="p">(</span><span class="o">~</span><span class="n">a</span> <span class="o">&amp;</span> <span class="mi">1u</span><span class="p">)</span> <span class="n">a</span> <span class="o">&gt;&gt;=</span> <span class="mi">1u</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span> <span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">while</span> <span class="p">((</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">));</span>
	<span class="k">return</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="çº¦æ•°ä¸ªæ•°">çº¦æ•°ä¸ªæ•°</h3> <blockquote> <p>\(cnt = \textstyle\prod_{i = 1}^s(k_i + 1)\)ï¼Œå‚æ•°æ„ä¹‰å‚è€ƒç®—æ•°åŸºæœ¬å®šç†</p> </blockquote> <p>è¯æ˜å¦‚ä¸‹</p> \[\begin{aligned} \because\quad&amp;n = \textstyle\prod_{i = 1}^s{p_i}^{k_i}\newline \therefore\quad&amp;\forall x = \textstyle\prod_{i = 1}^s{p_i}^{\alpha_i}ï¼Œå…¶ä¸­x\mid n,\ 0\leqslant\alpha_i\leqslant k_i\newline åˆ\because\quad&amp;ä»»æ„ä¸€ä¸ªæ­£æ•´æ•°å¯ä»¥è¢«å”¯ä¸€åˆ†è§£\newline \therefore\quad&amp;ä»»æ„ä¸€ä¸ªnåˆ†è§£å¼å¯ä»¥å”¯ä¸€ç¡®å®šnçš„ä¸€ä¸ªçº¦æ•°x\newline åˆ\because\quad&amp;åˆ†è§£å¼\textstyle\prod_{i = 1}^s(k_i + 1)ä¸­ç»„åˆæ–¹å¼\newline \therefore\quad&amp;cnt= \textstyle\prod_{i = 1}^s{k_i + 1} \end{aligned}\] <p>åˆ©ç”¨å¯¹nåˆ†è§£è´¨å› æ•°çš„ç»“æœæ¥æ±‚è§£çº¦æ•°ä¸ªæ•°å¾ˆå®¹æ˜“</p> \[\begin{aligned} &amp;get\ map&lt;p_i,\ k_i&gt;\ by\ pfactor\quad //\ unordered\ is\ ok\newline &amp;ret = 1\newline &amp;loop\quad k_i\ in\ map&lt;p_i,\ k_i&gt;\newline &amp;\hphantom{loop\quad}ret = ret\times(k_i + 1)\newline &amp;return\quad ret \end{aligned}\] <h3 id="çº¦æ•°ä¹‹å’Œ">çº¦æ•°ä¹‹å’Œ</h3> <blockquote> \[sum = \displaystyle\prod_{i = 1}^s\textstyle\sum_{\alpha_i = 0}^{k_i}{p_i}^{\alpha_i}\] </blockquote> <p>è¯¥ç­‰å¼çš„è¯æ˜å¾ˆç®€å•ï¼Œå°†å…¶å±•å¼€å³å¾—åˆ°äº†æ‰€æœ‰çš„çº¦æ•°</p> \[sum = ({p_1}^0 + {p_1}^1 + \cdots + {p_1}^{k_1}) \times ({p_2}^0 + {p_2}^1 + \cdots + {p_2}^{k_2}) \times ({p_s}^0 + {p_s}^1 + \cdots + {p_s}^{k_s})\] <p>ä¼ªä»£ç å¦‚ä¸‹</p> \[\begin{aligned} &amp;get\ map&lt;p_i,\ k_i&gt;\ by\ pfactor\quad//\ unordered\ is\ ok\newline &amp;ret = 1\newline &amp;loop\quad &lt;p_i,\ k_i&gt;\ in\ map&lt;p_i,\ k_i&gt;\newline &amp;\hphantom{loop\quad}t = 1\newline &amp;\hphantom{loop\quad}loop\quad k_i\ times\newline &amp;\hphantom{loop\quad loop\quad}t = t \times p_i + 1\newline &amp;\hphantom{loop\quad}ret = ret\times t\newline &amp;return\quad ret \end{aligned}\] <p>å¾ˆæ˜æ˜¾å…³é”®åœ¨äºå¯¹\(\sum_{\alpha_i = 0}^{k_i}{p_i}^{\alpha_i}\)èƒ½å¤Ÿå¿«é€Ÿæ±‚è§£ï¼Œåœ¨æ•°å€¼è¾ƒå°æ—¶å¯ä»¥ä½¿ç”¨ä¸Šé¢çš„ç§¦ä¹éŸ¶ç®—æ³•ï¼Œå½“æ•°å€¼æå¤§æ—¶å¯ä»¥ä½¿ç”¨ä¸‹é¢ä¸¤ç§æ–¹æ³•ã€‚</p> <p>æ–¹æ³•ä¸€ï¼šé€’å½’</p> <ul> <li>å½“\(k_i\)ä¸ºå¥‡æ•°æ—¶ï¼Œå…±æœ‰\(k_i + 1\)(å¶æ•°)é¡¹</li> </ul> \[\def\p{ {p_i} } \def\lrk{\frac{k_i + 1}2} \textstyle\begin{aligned} f(p_i, k_i) = \sum_{\alpha_i = 0}^{k_i}\p^{\alpha_i} &amp;= \p^0 + \p^1 + \cdots + \p^{k_i}\newline &amp;= (\p^0 + \p^1 + \cdots + \p^{\lrk - 1}) + (\p^{\lrk} + \p^{\lrk + 1} + \cdots + \p^{k_i})\newline &amp;= (\p^0 + \p^1 + \cdots + \p^{\lrk - 1}) + \p^{\lrk}\cdot (\p^0 + \p^1 + \cdots + \p^{\lrk - 1})\newline &amp;= (1 + \p^{\lrk}) \cdot (\p^0 + \p^1 + \cdots + \p^{\lrk - 1})\newline &amp;= (1 + \p^{\lrk}) \cdot f(p_i, \textstyle\lrk - 1) \end{aligned}\] <ul> <li>å½“\(k_i\)ä¸ºå¶æ•°æ—¶</li> </ul> \[\def\p{ {p_i} } \begin{aligned} f(p_i, k_i) &amp;= \p^0 + \p \cdot (\p^0 + \p^1 + \cdots + \p^{k_i - 1})\newline &amp;= 1 + \p \cdot (1 + \p^{\frac{k_i}2}) \cdot f(\p, \textstyle\frac{k_i}2 - 1) \end{aligned}\] <p>æ–¹æ³•äºŒï¼šå…¬å¼</p> \[\begin{aligned} \sum_{\alpha_i = 0}^{k_i}{p_i}^{\alpha_i} &amp;= \frac{ {p_i}^{k_i + 1} - 1}{p_i - 1}\newline &amp;= ({p_i}^{k_i + 1} - 1) \cdot (p_i - 1)^{-1} \end{aligned}\] <p>æ³¨æ„ï¼š<em>ç”±äºæ˜¯å¯¹ç‰¹åˆ«å¤§çš„æ•°è¿›è¡Œæ“ä½œï¼Œä¸€å®šæ˜¯éœ€è¦å–æ¨¡çš„ï¼Œæ‰€ä»¥éœ€è¦å°†é™¤æ³•è½¬åŒ–ä¸ºä¹˜æ³•é€†å…ƒï¼ˆä¸‹æ–‡ï¼‰çš„è®¡ç®—ï¼Œé…åˆå¿«é€Ÿå¹‚è¿›è¡Œæ±‚è§£ã€‚</em></p> <h2 id="è´¨æ•°">è´¨æ•°</h2> <blockquote> <p>å¯¹äºå¤§äº\(2\)çš„è‡ªç„¶æ•°ï¼Œè‹¥å…¶å› å­åªæœ‰\(1\)å’Œè‡ªèº«ï¼Œåˆ™è¯¥æ•°ä¸ºè´¨æ•°</p> </blockquote> <h3 id="è¯•é™¤æ³•åˆ¤å®šè´¨æ•°">è¯•é™¤æ³•åˆ¤å®šè´¨æ•°</h3> \[\begin{aligned} &amp;if\quad x\leqslant 2\newline &amp;\hphantom{if\quad}return\quad x\ equal\ 2\newline &amp;if\quad 2\mid x\newline &amp;\hphantom{if\quad}return\quad false\newline &amp;for\quad i = 3, mid = \sqrt x; i\leqslant mid; i = i + 2\newline &amp;\hphantom{for\quad}if\quad i\mid x\newline &amp;\hphantom{for\quad if\quad}return\quad false\newline &amp;return\quad true \end{aligned}\] <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">type</span> <span class="p">&gt;</span>
<span class="kt">bool</span> <span class="nf">prime</span><span class="p">(</span><span class="n">type</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="k">return</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">2</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mi">1u</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">type</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
	<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="è´¨æ•°è®¡æ•°å‡½æ•°">è´¨æ•°è®¡æ•°å‡½æ•°</h3> <blockquote> <p>\(\pi(x)\)è¡¨ç¤ºä¸å¤§äº\(x\)çš„è´¨æ•°çš„ä¸ªæ•°</p> </blockquote> <p>æ»¡è¶³æ€§è´¨\(\displaystyle\lim_{x\rightarrow \inf}\pi(x) = \frac x{\ln x}\)</p> <ul> <li>ç»éªŒ: \(\forall x,\ \pi(x)\leqslant\lfloor \frac x{\ln x} \times 1.2\rfloor\)</li> </ul> <h3 id="è´¨æ•°ç­›">è´¨æ•°ç­›</h3> <p>è¿™é‡Œå…ˆè¯´ä¸€ä¸‹<strong>å¥‡æ•°ç­›<sup id="fnref:odd_sieve" role="doc-noteref"><a href="#fn:odd_sieve" class="footnote" rel="footnote">2</a></sup></strong>çš„æ¦‚å¿µï¼Œè¿™ä¸ªåå­—ä»¥åŠåšæ³•æ˜¯æˆ‘è‡ªå·±æ€è€ƒå¾—åˆ°çš„ï¼Œä¸çŸ¥é“ä¹‹å‰æœ‰æ²¡æœ‰äººæƒ³åˆ°å’Œä½¿ç”¨è¿‡ã€‚ç”±äºé™¤äº†\(2\)ä»¥å¤–çš„æ‰€æœ‰è´¨æ•°éƒ½æ˜¯å¥‡æ•°ï¼Œæ‰€ä»¥å¯ä»¥å…ˆç‰¹åˆ¤\(2\)ï¼Œç„¶ååœ¨å¥‡æ•°ä¸­ç­›é€‰è´¨æ•°ï¼Œä¸‹é¢ä¸¤ä¸ªè´¨æ•°ç­›ä½¿ç”¨äº†<strong>å¥‡æ•°è´¨æ•°ç­›</strong>æ¥å®ç°ã€‚åé¢çš„æ¬§æ‹‰å‡½æ•°ç­›ä¹Ÿè¿ç”¨äº†å¥‡æ•°ç­›ï¼Œåæ–‡è¯¦ç»†è¯´æ˜ã€‚</p> <h4 id="åŸƒæ°è´¨æ•°ç­›">åŸƒæ°è´¨æ•°ç­›</h4> <p>åŸƒæ°ç­›çš„æ€æƒ³ç®€å•æ˜“æ‡‚ï¼šå¯ä»¥ç”¨ä¸€ä¸ªæ•°ç­›æ‰æ‰€æœ‰èƒ½è¢«è¯¥æ•°æ•´é™¤çš„æ•°ã€‚</p> \[\begin{aligned} &amp;if\quad n &lt; 2\newline &amp;\hphantom{if\quad}return\quad 0\newline &amp;ret = \lfloor \frac{n + 1}2 \rfloor\newline &amp;for\quad base = 3; base \leqslant \lfloor \frac n3\rfloor; base = base + 2\newline &amp;\hphantom{for\quad}if\quad !ar[\lfloor\frac{base}2\rfloor]\newline &amp;\hphantom{for\quad if\quad}for\quad k = base\times 3; k \leqslant n; k = k + base\times2\newline &amp;\hphantom{for\quad if\quad for\quad}if\quad !ar[\lfloor \frac k2\rfloor]\newline &amp;\hphantom{for\quad if\quad for\quad if\quad}ar[\lfloor \frac k2\rfloor] = true\newline &amp;\hphantom{for\quad if\quad for\quad if\quad}ret = ret - 1\newline &amp;return\quad ret \end{aligned}\] <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">eratos</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">base</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">des</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="mi">3</span><span class="p">;</span> <span class="n">base</span> <span class="o">&lt;=</span> <span class="n">des</span><span class="p">;</span> <span class="n">base</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ar</span><span class="p">[</span><span class="n">base</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">])</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">base</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="n">base</span> <span class="o">&lt;&lt;</span> <span class="mi">1u</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">k</span> <span class="o">+=</span> <span class="n">step</span><span class="p">)</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ar</span><span class="p">[</span><span class="n">k</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">])</span> <span class="n">ar</span><span class="p">[</span><span class="n">k</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span> <span class="o">--</span><span class="n">ret</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h4 id="æ¬§æ‹‰è´¨æ•°ç­›">æ¬§æ‹‰è´¨æ•°ç­›</h4> <p>æ¬§æ‹‰ç­›æ˜¯çº¿æ€§çš„ï¼Œå› ä¸ºå…¶ä¿è¯äº†æ¯ä¸ªåˆæ•°ä»…è¢«å…¶æœ€å°è´¨å› å­ç­›æ‰ä¸€æ¬¡ã€‚</p> \[\begin{aligned} &amp;vector\ prs\ reserve\ \lfloor \frac n{\ln n}\times 1.2 \rfloor\newline &amp;if\quad n &lt; 2\newline &amp;\hphantom{if\quad}return\quad 0\newline &amp;for\quad i = 3; i\leqslant n; i = i + 2\newline &amp;\hphantom{for\quad}if\quad !ar[\lfloor \frac i2 \rfloor]\newline &amp;\hphantom{for\quad if\quad}prs\ push\ back\ i\newline &amp;\hphantom{for\quad}loop\quad p_j\ in\ prs\ when\ p_j\leqslant \lfloor\frac ni \rfloor\newline &amp;\hphantom{for\quad loop\quad}ar[\lfloor\frac{p_j\times i}2\rfloor] = true\newline &amp;\hphantom{for\quad loop\quad}if\quad p_j\mid i\newline &amp;\hphantom{for\quad loop\quad if\quad}break\newline &amp;return\quad 1 + the\ size\ of\ prs \end{aligned}\] <blockquote> <p>æ¬§æ‹‰ç­›æ˜¯å¦‚ä½•ä¿è¯æ¯ä¸ªåˆæ•°ä»…è¢«å…¶æœ€å°è´¨å› å­ç­›æ‰ä¸€æ¬¡çš„å‘¢ï¼Ÿ</p> <p>å…³é”®åœ¨äºç­›åˆæ•°è¿‡ç¨‹çš„ä¸­æ–­æ¡ä»¶æ˜¯\(p_j\mid i\)ï¼Œå› ä¸ºæ»¡è¶³è¯¥æ¡ä»¶çš„\(p_j\)ä¹Ÿä¸€å®šæ»¡è¶³\(p_j\mid (p_{j + k}\times i), k\in \mathbb{Z}^+\)ã€‚</p> </blockquote> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">euler</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">prs</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">])</span> <span class="n">prs</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">des</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="n">prs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">des</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">ar</span><span class="p">[</span><span class="n">prs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">prs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">prs</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h2 id="æ¬§æ‹‰å‡½æ•°">æ¬§æ‹‰å‡½æ•°</h2> <blockquote> <p>\(\varphi(n)\)è¡¨ç¤ºä¸å¤§äº\(n\)ä¸”å’Œ\(n\)äº’è´¨çš„æ­£æ•´æ•°çš„ä¸ªæ•°</p> </blockquote> <p>å¯¹äºæ¬§æ‹‰å‡½æ•°çš„å€¼çš„è¡¨è¾¾ä¸åšä¸¥æ ¼çš„è¯æ˜ï¼Œè€Œæ˜¯ç”¨â€œè‡ªè¯æ˜â€ä»¥ä¾¿äºç†è§£</p> \[\begin{aligned} \varphi(n)&amp;= \varphi(\textstyle\prod_{i = 1}^s p_i^{k_i})\newline &amp;= \textstyle\prod_{i = 1}^s\varphi(p_i^{k_i})\newline &amp;= \textstyle\prod_{i = 1}^s(p_i^{k_i - 1}\times (p_i - 1))\newline &amp;= \textstyle\prod_{i = 1}^s(p_i^{k_i}\times \frac{p_i - 1}{p_i})\newline &amp;= n\times\textstyle\prod_{i = 1}^s\frac{p_i - 1}{p_i} \end{aligned}\] <blockquote> <p>è¿™é‡Œç”¨åˆ°äº†ä»¥ä¸‹æ€§è´¨</p> <ul> <li>\(s = 1\)ï¼Œå³\(n = p^k\)æ—¶ï¼Œ\(\varphi(n) = p^{k - 1}\times(p - 1) = p^k - p^{k - 1}\)</li> <li>æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°ï¼Œå³è‹¥\(a\nmid b\)ï¼Œåˆ™\(\varphi(a\times b) = \varphi(a)\times\varphi(b)\)</li> </ul> </blockquote> <p>æ­¤å¤–ï¼Œæ¬§æ‹‰å‡½æ•°è¿˜æœ‰å…¶ä»–é‡è¦çš„æ€§è´¨ï¼Œå…¶ä¸­æ˜¾è€Œæ˜“è§çš„ä¸€ä¸ªæ˜¯</p> <ul> <li>å½“\(n\)ä¸ºè´¨æ•°æ—¶ï¼Œ\(\varphi(n) = n - 1\)</li> </ul> <p>è‡³æ­¤ï¼Œåˆ©ç”¨è¿™äº›æ€§è´¨å’Œç®—æ•°åŸºæœ¬å®šç†å¯ä»¥æ¥æ±‚è§£æ¬§æ‹‰å‡½æ•°çš„å€¼äº†</p> \[\begin{aligned} &amp;get\ map&lt;p_i, k_i&gt;\ by\ pfactor\quad\text{//unordered is ok}\newline &amp;ret = n\newline &amp;loop\quad p_i\ in\ map&lt;p_i, k_i&gt;\newline &amp;\hphantom{loop\quad}ret = \frac{ret\times(p_i - 1)}{p_i}\newline &amp;return\quad ret \end{aligned}\] <h3 id="æ¬§æ‹‰å‡½æ•°ç­›">æ¬§æ‹‰å‡½æ•°ç­›</h3> <p>åŸç†å¦‚ä¸‹</p> \[\begin{aligned} å½“nä¸ºè´¨æ•°&amp;\newline &amp;\varphi(n) = n - 1\newline å½“nä¸ºåˆæ•°&amp;\newline &amp;è®¾p_{min}æ˜¯nçš„æœ€å°è´¨å› å­ï¼Œåˆ™åœ¨æ¬§æ‹‰ç­›ä¸­è¢«p_{min}\times\frac n{p_{min}}ç­›æ‰\newline &amp;if\quad p_{min}\nmid \frac n{p_{min}}\newline &amp;\hphantom{if\quad}\because\quad æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°\newline &amp;\hphantom{if\quad}\therefore\quad \varphi(n) = \varphi(p_{min})\times\varphi(\frac n{p_{min}})\newline &amp;\hphantom{if\quad\therefore\quad\varphi(n)} = (p_{min} - 1)\times\varphi(\frac n{p_{min}})\newline &amp;else\ (å³p_{min}\mid \frac n{p_{min}})\newline &amp;\hphantom{if\quad}\because\quad \frac n{p_{min}}ä¸nçš„è´¨å› å­é›†åˆç›¸åŒ\newline &amp;\hphantom{if\quad}\therefore\quad\varphi(n) = n\times\prod_{i = 1}^s \frac{p_i - 1}{p_i}\newline &amp;\hphantom{if\quad\therefore\quad\varphi(n)}= p_{min}\times \frac n{p_{min}}\times\prod_{i = 1}^s\frac{p_i - 1}{p_i}\newline &amp;\hphantom{if\quad\therefore\quad\varphi(n)}= p_{min}\times\varphi(\frac n{p_{min}}) \end{aligned}\] <p>åœ¨å…·ä½“çš„å®ç°ä¸Šæˆ‘ä¾æ—§ä½¿ç”¨<strong>å¥‡æ•°ç­›</strong>ï¼Œè¿™æ˜¯æˆ‘æ ¹æ®æ— æ„ä¸­å‘ç°çš„æ¬§æ‹‰å‡½æ•°çš„å¦ä¸€ä¸ªæ€§è´¨ç»è¿‡æ€è€ƒå¾—åˆ°çš„æ–¹æ³•ï¼Œç›®å‰æ²¡æœ‰å‘ç°ç½‘ç»œä¸Šæµä¼ æœ‰ç±»ä¼¼åšæ³•ã€‚è¯¥æ€§è´¨è¡¨ç¤ºä¸º</p> \[\varphi(2n) = \begin{cases}\varphi(n),&amp;2\nmid n\newline2\times\varphi(n),å³\varphi(\frac n{lowbit(n)})\times\frac{lowbit(n)}2,&amp;2\mid n\end{cases}\] <p>æ ¸å¿ƒè¿‡ç¨‹å¦‚ä¸‹</p> \[\begin{aligned} &amp;vector\ prs\ reserve\ \lfloor \frac n{\ln n}\times 1.2 \rfloor\newline &amp;phi[\lfloor\frac 12\rfloor] = 1\newline &amp;for\quad i = 3; i\leqslant n; i = i + 2\newline &amp;\hphantom{for\quad}if\quad !ar[\lfloor\frac i2\rfloor]\newline &amp;\hphantom{for\quad if\quad}prs\ push\ back\ i\newline &amp;\hphantom{for\quad if\quad}phi[\lfloor \frac i2\rfloor] = i - 1\newline &amp;\hphantom{for\quad}loop\quad p_j\ in\ prs\ when\ p_j\leqslant\lfloor\frac ni\rfloor\newline &amp;\hphantom{for\quad loop\quad}ar[\lfloor\frac{p_j\times i}2\rfloor] = true\newline &amp;\hphantom{for\quad loop\quad}if\quad p_j\mid i\newline &amp;\hphantom{for\quad loop\quad if\quad}phi[\lfloor\frac{p_j\times i}2\rfloor] = p_j\times phi[\lfloor\frac i2\rfloor]\newline &amp;\hphantom{for\quad loop\quad if\quad}break\newline &amp;\hphantom{for\quad loop\quad}else\newline &amp;\hphantom{for\quad loop\quad if\quad}phi[\lfloor\frac{p_j\times i}2\rfloor] = phi[\lfloor\frac{p_j}2\rfloor]\times phi[\lfloor\frac i2\rfloor] \end{aligned}\] <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">sieve</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">prs</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">);</span>
	<span class="n">phi</span><span class="p">[</span><span class="mi">1</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">])</span> <span class="p">{</span>
			<span class="n">prs</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			<span class="n">phi</span><span class="p">[</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">des</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span> <span class="n">prs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">des</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">ar</span><span class="p">[</span><span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">prs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">prs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">phi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">prs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">];</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="n">phi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="n">prs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">]</span> <span class="o">*</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">];</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">euler</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mi">1u</span><span class="p">)</span> <span class="k">return</span> <span class="n">phi</span><span class="p">[</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">];</span>
	<span class="k">else</span> <span class="k">return</span> <span class="n">phi</span><span class="p">[</span><span class="n">n</span> <span class="o">/</span> <span class="n">lowbit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">]</span> <span class="o">*</span> <span class="n">lowbit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h2 id="æ¬§æ‹‰å®šç†ä¸è´¹é©¬å°å®šç†">æ¬§æ‹‰å®šç†ä¸è´¹é©¬å°å®šç†</h2> <h3 id="æ¬§æ‹‰å®šç†">æ¬§æ‹‰å®šç†</h3> <blockquote> <p>è‹¥\(a\nmid p\)ï¼Œåˆ™\(a^{\varphi(p)}\equiv 1\pmod p\)</p> </blockquote> <h3 id="è´¹é©¬å°å®šç†">è´¹é©¬å°å®šç†</h3> <p>å¯¹äºæ¬§æ‹‰å®šç†ï¼Œå½“\(p\)ä¸ºè´¨æ•°æ—¶ï¼Œå³ç‰¹åŒ–ä¸ºè´¹é©¬å°å®šç†</p> <blockquote> <p>è‹¥\(a\nmid p\)ä¸”\(p\)ä¸ºè´¨æ•°ï¼Œåˆ™\(a^{p - 1}\equiv 1\pmod p\)ï¼Œå³ \(a^p\equiv a\pmod p\)</p> </blockquote> <h2 id="è£´èœ€è´ç¥–å®šç†ä¸æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•">è£´èœ€/è´ç¥–å®šç†ä¸æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</h2> <h3 id="è£´èœ€è´ç¥–å®šç†">è£´èœ€/è´ç¥–å®šç†</h3> <blockquote> <p>å¯¹äº\(\forall a, b \in \mathbb{Z^+}, \exists x, y \in \mathbb{Z}\)ä½¿å¾—\(ax + by = gcd(a, b)\)</p> </blockquote> <h3 id="æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•">æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</h3> <p>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å°±æ˜¯ç”¨äºæ±‚è§£å½¢å¦‚è£´èœ€å®šç†çš„é—®é¢˜ï¼Œå…¶æ ¸å¿ƒæ€æƒ³å¦‚ä¸‹</p> \[\begin{aligned} &amp;load\ program\ exgcd(a, b, x, y)\newline &amp;if\quad b\ equal\ 0\newline &amp;\hphantom{if\quad}exist gcd(a, b) = a\newline &amp;\hphantom{if\quad}get\ ax + 0y = gcd(a, 0)\newline &amp;\hphantom{if\quad}obtain\quad x = 1\newline &amp;else\newline &amp;\hphantom{if\quad}gcd(a, b) = gcd(b, a\ mod\ b)\newline &amp;\hphantom{if\quad gcd(a, b)}= gcd(b, a - \lfloor \frac ab\rfloor\cdot b)\newline &amp;\hphantom{if\quad}get\ by + (a - \lfloor \frac ab\rfloor\cdot b)\cdot x = gcd(a, b)\newline &amp;\hphantom{if\quad}get\ ax + b\cdot (y - \lfloor \frac ab\rfloor\cdot x) = gcd(a, b)\newline &amp;\hphantom{if\quad}perform\ recursion\ exgcd(b, a\ mod\ b, y, x)\newline &amp;\hphantom{if\quad}obtain\quad x = x, y = y - \lfloor \frac ab\rfloor \end{aligned}\] <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">type</span> <span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">exgcd</span><span class="p">(</span><span class="n">type</span> <span class="n">a</span><span class="p">,</span> <span class="n">type</span> <span class="n">b</span><span class="p">,</span> <span class="n">type</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="n">type</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">exgcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
		<span class="n">y</span> <span class="o">-=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="c1">// ä»¤y = 0é˜²æ­¢å¤šç»„æ•°æ®æº¢å‡º</span>
<span class="p">}</span>
</code></pre></div></div> <blockquote> <p>Tipsï¼šè‹¥\(a\)ä¸ºè´Ÿæ•°ï¼Œåˆ™å°†é—®é¢˜è½¬åŒ–ä¸º\(\mid a\mid\cdot(-x) + by = gcd(\mid a\mid, b)\)ï¼Œ\(b\)ä¸ºè´Ÿæ•°åŒç†</p> </blockquote> <h2 id="åŒä½™">åŒä½™</h2> <h3 id="çº¿æ€§åŒä½™æ–¹ç¨‹">çº¿æ€§åŒä½™æ–¹ç¨‹</h3> <blockquote> <p>å½¢å¦‚\(ax + by = c\)ï¼Œå³\(ax\equiv c \pmod b\)çš„ä¸€æ¬¡æ–¹ç¨‹ä¸ºçº¿æ€§åŒä½™æ–¹ç¨‹</p> <p>è‹¥\(gcd(a, b)\mid c\)ï¼Œåˆ™\(x\)æœ‰æ•´æ•°è§£</p> </blockquote> <p>åˆ©ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚è§£çš„åŸç†å¦‚ä¸‹</p> \[\begin{gathered} ç”±æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚è§£ç¿¡èœ€å®šç†å¾—åˆ°x'ä½¿å¾—\newline ax' \equiv gcd(a, b)\pmod b\newline å¯¹äº\quad ax\equiv c\pmod b\quadçš„æ•´æ•°è§£\newline æœ‰å……è¦æ¡ä»¶\quad gcd(a, b)\mid c\newline åˆ™å¾—åˆ°ä¸€ä¸ªè§£\quad x_0 = \frac{c\cdot x'}{gcd(a, b)}\newline ä»»æ„è§£\quad x = \frac{c\cdot x' + k\cdot b}{gcd(a, b)}, k\in\mathbb{Z} \end{gathered}\] <h3 id="ä¹˜æ³•é€†å…ƒ">ä¹˜æ³•é€†å…ƒ</h3> <blockquote> <p>å¯¹äºçº¿æ€§åŒä½™æ–¹ç¨‹\(ax\equiv c\pmod b\)ï¼Œå½“\(c = 1\)æ—¶ï¼Œ\(x\)çš„è§£å³ä¸º\(a\ mod\ b\)çš„ä¹˜æ³•é€†å…ƒï¼Œè®°åš\(a^{-1}\)</p> </blockquote> <p>ä¹˜æ³•é€†å…ƒæœ‰è§£çš„æ¡ä»¶</p> \[\begin{aligned} \because\quad&amp;çº¿æ€§åŒä½™æ–¹ç¨‹æœ‰è§£çš„æ¡ä»¶æ˜¯\quad gcd(a, b)\mid c\newline åˆ\because\quad&amp;ç‰¹åŒ–ä¸ºä¹˜æ³•é€†å…ƒè¦æ±‚\quad c = 1\newline \therefore\quad&amp;gcd(a, b) = 1,\quadå³\quad a\nmid b\quad ä¸ºä¹˜æ³•é€†å…ƒæœ‰è§£çš„æ¡ä»¶ \end{aligned}\] <p>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•åŒæ ·é€‚ç”¨æ±‚è§£ä¹˜æ³•é€†å…ƒï¼Œç‰¹æ®Šçš„ï¼Œå½“\(p\)ä¸ºè´¨æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¿«é€Ÿå¹‚æ±‚è§£ï¼ŒåŸç†å¦‚ä¸‹</p> \[\begin{aligned} \because\quad&amp;ä¹˜æ³•é€†å…ƒæ»¡è¶³&amp;a\cdot a^{-1}&amp;\equiv 1&amp;\pmod p\newline åˆ\because\quad&amp;è´¹é©¬å°å®šç†&amp;a^{p - 1}&amp;\equiv 1&amp;\pmod p\newline &amp;å³&amp;a\cdot a^{-2}&amp;\equiv 1&amp;\pmod p\newline \therefore\quad&amp;&amp;a^{-1}&amp;\equiv a^{p - 2}&amp;\pmod p \end{aligned}\] <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:lowbit" role="doc-endnote"> <p>ä¸€ä¸ªæœ‰å…³äºŒè¿›åˆ¶çš„å‡½æ•°ï¼Œè¿”å›\(-x \&amp; x\)ï¼Œä¹Ÿå³\((\sim x + 1) \&amp; x\)ï¼Œå…¶è¿”å›å€¼æ˜¯\(2\)çš„â€œ\(x\)åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹æœ«å°¾\(0\)çš„ä¸ªæ•°â€æ¬¡æ–¹ã€‚Â <a href="#fnref:lowbit" class="reversefootnote" role="doc-backlink">â†©</a></p> </li> <li id="fn:odd_sieve" role="doc-endnote"> <p>å¯¹äºä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸€ä¸ªå¥‡æ•°\(x\)å¯ä»¥å”¯ä¸€åœ°æ˜ å°„åˆ°ä¸‹æ ‡ä¸º\(\lfloor \frac x2\rfloor\)çš„å…ƒç´ ã€‚Â <a href="#fnref:odd_sieve" class="reversefootnote" role="doc-backlink">â†©</a></p> </li> </ol> </div> </div> </div> </div> </div> </div> <footer> <div class="container"> <div class="row"> <div class="col-lg-8"> <p>Mooyyu Crab.'s Blog <i class="fa fa-heart text-danger" aria-hidden="true"></i>. Check out <a href="//github.com/mooyyu/mooyyu.github.io" target="_blank">Github Project <i class="fa fa-github-alt" aria-hidden="true"></i></a>.<br> The contents of this website are Â© 2021 under the terms of the <a href="//www.gnu.org/licenses/gpl-3.0.txt" target="_blank">GPLv3</a> License.</p> </div> <div class="col-lg-4"> <div class="pull-right"> <a href="#top" data-proofer-ignore> Back to top <i class="fa fa-level-up" aria-hidden="true"></i></a> </div> </div> </div> </div> </footer> <div style="width: 100%; overflow-x: hidden;"> <canvas class="fireworks" style="position:fixed;left:0;top:0;z-index:99999999;pointer-events:none;"></canvas> </div> <script>
  MathJax = {
    options: {
      enableMenu: false
    }
  };
</script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-svg.js"></script> <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-128176907-1', {
          'cookieDomain': 'mooyyu.github.io',
          'siteSpeedSampleRate': 80
      });

      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script> </body> </html>
