<!DOCTYPE html>
<html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="flattr:id" content="e7nqg5"> <title>çº¿æ®µæ ‘ä¹‹æ‰«æçº¿æµ…è°ˆ | Mooyyu Crab.</title> <meta name="generator" content="Jekyll v3.9.0"> <meta property="og:title" content="çº¿æ®µæ ‘ä¹‹æ‰«æçº¿æµ…è°ˆ"> <meta name="author" content="mooyyu"> <meta property="og:locale" content="en_US"> <meta name="description" content="çº¿æ®µæ ‘çš„å¸¸è§åº”ç”¨ä¹‹ä¸€"> <meta property="og:description" content="çº¿æ®µæ ‘çš„å¸¸è§åº”ç”¨ä¹‹ä¸€"> <link rel="canonical" href="https://mooyyu.github.io/docs/algorithm/Graph-segment_tree_scan.html"> <meta property="og:url" content="https://mooyyu.github.io/docs/algorithm/Graph-segment_tree_scan.html"> <meta property="og:site_name" content="Mooyyu Crab."> <meta property="og:type" content="article"> <meta property="article:published_time" content="2021-01-29T16:25:39+00:00"> <script type="application/ld+json">
{"headline":"çº¿æ®µæ ‘ä¹‹æ‰«æçº¿æµ…è°ˆ","dateModified":"2021-01-29T16:25:39+00:00","datePublished":"2021-01-29T16:25:39+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mooyyu.github.io/docs/algorithm/Graph-segment_tree_scan.html"},"author":{"@type":"Person","name":"mooyyu"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://mooyyu.github.io/assets/images/logo/mooyyu/m.png"},"name":"mooyyu"},"description":"çº¿æ®µæ ‘çš„å¸¸è§åº”ç”¨ä¹‹ä¸€","url":"https://mooyyu.github.io/docs/algorithm/Graph-segment_tree_scan.html","@type":"BlogPosting","@context":"https://schema.org"}</script> <link rel="icon" href="/assets/favicon.ico"> <link rel="stylesheet" href="/assets/stylesheets/main.css?v=20210128-1"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script><![endif]--> <script src="/assets/javascript/head.min.js"></script> <script type="text/javascript">

      /**
       * As Github pages do not support https for custom domains
       * this is the current best workaround for #18.
       */
      var domains  = [ 'mooyyu.github.io', 'localhost', '127.0.0.1' ];
      var pathname = location.pathname.replace(/^\/Mooyyu Crab.'s Github Page/, '')
      if (domains.indexOf(window.location.hostname) == -1)
        window.top.location.href = 'https://mooyyu.github.io' + pathname;

      /**
       * Another ugly workaround trying to improve UX reported by #35
       */
      if (location.protocol != 'https:' && window.location.hostname == 'mooyyu.github.io')
        location.href = 'https:' + window.location.href.substring(window.location.protocol.length);

      /**
       * Improves overall speed by loading javascript and css resources in parallel
       * with the main page.
       */
      head.load(
          "/assets/stylesheets/font-awesome.min.css",

          "/assets/javascript/jquery-2.2.1.min.js",
          "/assets/javascript/jquery-ui.min.js",
          "/assets/javascript/bootstrap.min.js",
          "/assets/javascript/tocify.min.js",
          "/assets/javascript/custom.js",

          "/assets/javascript/sheetrock.min.js",
          "/assets/javascript/cookieconsent.min.js",
          "/assets/javascript/pop.min.js"
      );

      head.ready(function() {
        window.cookieconsent_options = {
          "message":"This site use cookies to ensure you get the best experience on the website",
          "dismiss": "Got it!", "learnMore": "More info", "link":"", "theme": "dark-bottom"
        };
        $("body").on('click', '[data-stopPropagation]', function (e) {
          e.stopPropagation();
        });
      });
    </script> </head> <body role="document"> <nav class="navbar navbar-default navbar-fixed-top custom-no-margin"> <div class="container"> <div class="navbar-header"> <a href="/" class="navbar-brand" style="color: slategrey;"> Mooyyu Crab.'s Blog </a> <img id="daynite" src="/assets/images/btn-night.svg" alt="Dark Mode" width="32" height="32"> <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> </div> <div class="navbar-collapse collapse" id="navbar-main"> <ul class="nav navbar-nav"> <li><a href="/whoami/">WHO AM I? </a></li> <li class="dropdown siteindex"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-documentation">Site Index <span class="caret"></span></a> <ul class="dropdown-menu"> <li class="dropdown dropdown-submenu algorithm"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-stoppropagation="true" id="navbar-sub-algorithm">Algorithm</a> <ul class="dropdown-menu"> <li><a href="/meta/algorithm/"> All documents </a></li> <li class="divider"> <li><a href="/docs/algorithm/Math-1.html">ç®—æ³•ç«èµ›ç®€å•æ•°è®ºçŸ¥è¯†(ä¸€)</a></li> <li><a href="/docs/algorithm/DP-knapsack.html">åŠ¨æ€è§„åˆ’: èƒŒåŒ…é—®é¢˜ (ä¸€)</a></li> <li><a href="/docs/algorithm/Graph-shortest_path.html">å›¾è®ºæµ…è°ˆä¹‹æœ€çŸ­è·¯</a></li> <li><a href="/docs/algorithm/DP-linear.html">åŠ¨æ€è§„åˆ’å…¥é—¨ä¹‹çº¿æ€§æå€¼æ¨¡å‹</a></li> <li><a href="/docs/algorithm/DS-1.html">ç®—æ³•ç«èµ›ç®€å•æ•°æ®ç»“æ„(ä¸€)</a></li> <li><a href="/docs/algorithm/Graph-segment_tree_scan.html">çº¿æ®µæ ‘ä¹‹æ‰«æçº¿æµ…è°ˆ</a></li> <li><a href="/docs/algorithm/basic.html">åŸºç¡€ç®—æ³•æ‚è°ˆ</a></li> </ul> </li> <li class="dropdown dropdown-submenu oicode"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-stoppropagation="true" id="navbar-sub-oicode">OI-code</a> <ul class="dropdown-menu"> <li><a href="/meta/oicode/"> All documents </a></li> <li class="divider"> <li><a href="/docs/oicode/B1.html"><strong>B1</strong>: å‰ç¼€å’Œä¸å·®åˆ†</a></li> <li><a href="/docs/oicode/B2.html"><strong>B2</strong>: å¿«é€Ÿç»„åˆ</a></li> <li><a href="/docs/oicode/B3.html"><strong>B3</strong>: äºŒåˆ†æŸ¥æ‰¾</a></li> <li><a href="/docs/oicode/B4-add.html"><strong>B4</strong>: é«˜ç²¾åº¦åŠ æ³•</a></li> <li><a href="/docs/oicode/B4-div.html"><strong>B4</strong>: é«˜ç²¾åº¦é™¤æ³•</a></li> <li><a href="/docs/oicode/B4-multi.html"><strong>B4</strong>: é«˜ç²¾åº¦ä¹˜æ³•</a></li> <li><a href="/docs/oicode/B4-sub.html"><strong>B4</strong>: é«˜ç²¾åº¦å‡æ³•</a></li> <li><a href="/docs/oicode/D1.html"><strong>D1</strong>: å•è°ƒæ ˆ</a></li> <li><a href="/docs/oicode/D2.html"><strong>D2</strong>: å•è°ƒé˜Ÿåˆ—</a></li> <li><a href="/docs/oicode/D3.html"><strong>D3</strong>: Spare Table</a></li> <li><a href="/docs/oicode/D4.html"><strong>D4</strong>: å­—å…¸æ ‘</a></li> <li><a href="/docs/oicode/D5.html"><strong>D5</strong>: å¹¶æŸ¥é›†</a></li> <li><a href="/docs/oicode/D6-rc.html"><strong>D6</strong>: æ ‘çŠ¶æ•°ç»„-é™å®šåŒºé—´è®¡æ•°</a></li> <li><a href="/docs/oicode/D6-surs.html"><strong>D6</strong>: æ ‘çŠ¶æ•°ç»„-å•ç‚¹æ›´æ–°åŒºé—´æ±‚å’Œ</a></li> <li><a href="/docs/oicode/D7-basic.html"><strong>D7</strong>: çº¿æ®µæ ‘-åŸºç¡€</a></li> <li><a href="/docs/oicode/G1.html"><strong>G1</strong>: äºŒåˆ†å›¾-åˆ¤å®š</a></li> <li><a href="/docs/oicode/G2.html"><strong>G2</strong>: äºŒåˆ†å›¾-æœ€å¤§åŒ¹é…</a></li> <li><a href="/docs/oicode/G3.html"><strong>G3</strong>: Astar kçŸ­è·¯ on matrix</a></li> <li><a href="/docs/oicode/G4.html"><strong>G4</strong>: æ‹“æ‰‘æ’åº</a></li> <li><a href="/docs/oicode/G5.html"><strong>G5</strong>: è¿é€šæ— ç¯æ— å‘å›¾çš„é‡å¿ƒ</a></li> <li><a href="/docs/oicode/G6.html"><strong>G6</strong>: MST-Kruskal</a></li> <li><a href="/docs/oicode/G7.html"><strong>G7</strong>: MST-Prim</a></li> <li><a href="/docs/oicode/G8.html"><strong>G8</strong>: ShortestPath-BellmanFord</a></li> <li><a href="/docs/oicode/G9.html"><strong>G9</strong>: ShortestPath-Dijkstra</a></li> <li><a href="/docs/oicode/G9-hopt.html"><strong>G9</strong>: ShortestPath-Dijkstra Heap OPT</a></li> <li><a href="/docs/oicode/G10.html"><strong>G10</strong>: ShortestPath-SPFA</a></li> <li><a href="/docs/oicode/G11.html"><strong>G11</strong>: ShortestPath-Floyd</a></li> <li><a href="/docs/oicode/M1.html"><strong>M1</strong>: å¿«é€Ÿå¹‚ä¸é¾Ÿé€Ÿä¹˜</a></li> <li><a href="/docs/oicode/M2.html"><strong>M2</strong>: æ¬§å‡ é‡Œå¾—-æœ€å¤§å…¬çº¦æ•°</a></li> <li><a href="/docs/oicode/M2-ft.html"><strong>M2</strong>: EXæ¬§å‡ é‡Œå¾—-ç¿¡èœ€å®šç†</a></li> <li><a href="/docs/oicode/M2-lce.html"><strong>M2</strong>: EXæ¬§å‡ é‡Œå¾—-çº¿æ€§åŒä½™æ–¹ç¨‹</a></li> <li><a href="/docs/oicode/M2-mi.html"><strong>M2</strong>: EXæ¬§å‡ é‡Œå¾—-ä¹˜æ³•é€†å…ƒ</a></li> <li><a href="/docs/oicode/M3-flt.html"><strong>M3</strong>: è´¹é©¬å°å®šç†-ä¹˜æ³•é€†å…ƒ</a></li> <li><a href="/docs/oicode/M4.html"><strong>M4</strong>: åˆ†è§£è´¨å› æ•°</a></li> <li><a href="/docs/oicode/M4-euler.html"><strong>M4</strong>: åˆ†è§£è´¨å› æ•°-æ¬§æ‹‰å‡½æ•°</a></li> <li><a href="/docs/oicode/M4-prc.html"><strong>M4</strong>: åˆ†è§£è´¨å› æ•°-å¤šæ•°ä¹˜ç§¯çº¦æ•°è®¡æ•°</a></li> <li><a href="/docs/oicode/M4-prs.html"><strong>M4</strong>: åˆ†è§£è´¨å› æ•°-å¤šæ•°ä¹˜ç§¯çº¦æ•°æ±‚å’Œ</a></li> <li><a href="/docs/oicode/M5.html"><strong>M5</strong>: æ¬§æ‹‰ç­›</a></li> <li><a href="/docs/oicode/M5-ps.html"><strong>M5</strong>: æ¬§æ‹‰ç­›-è´¨æ•°ç­›</a></li> <li><a href="/docs/oicode/M6.html"><strong>M6</strong>: åŸƒæ°ç­›-è´¨æ•°ç­›</a></li> <li><a href="/docs/oicode/M7.html"><strong>M7</strong>: Steinç®—æ³•-æœ€å¤§å…¬çº¦æ•°</a></li> <li><a href="/docs/oicode/M8.html"><strong>M8</strong>: çŸ©é˜µä¹˜æ³•ä¸å¿«é€Ÿå¹‚</a></li> <li><a href="/docs/oicode/O1.html"><strong>O1</strong>: å¿«é€Ÿæ’åº</a></li> <li><a href="/docs/oicode/O2.html"><strong>O2</strong>: å¹¶å½’æ’åº</a></li> <li><a href="/docs/oicode/S1.html"><strong>S1</strong>: KMP</a></li> <li><a href="/docs/oicode/S2.html"><strong>S2</strong>: å­—ç¬¦ä¸²å“ˆå¸Œ</a></li> </ul> </li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-algorithm">ä¼ ç»Ÿç®—æ³• <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="/docs/algorithm/basic">åŸºç¡€ç®—æ³•æ‚è°ˆ</a></li> <li class="divider"> <li><a href="/docs/algorithm/DS-1">ç®—æ³•ç«èµ›ç®€å•æ•°æ®ç»“æ„(ä¸€)</a></li> <li class="divider"> <li><a href="/docs/algorithm/DP-knapsack">åŠ¨æ€è§„åˆ’:èƒŒåŒ…é—®é¢˜(ä¸€)</a></li> <li><a href="/docs/algorithm/DP-linear">åŠ¨æ€è§„åˆ’å…¥é—¨ä¹‹çº¿æ€§æå€¼æ¨¡å‹</a></li> <li class="divider"> <li><a href="/docs/algorithm/Graph-shortest_path">å›¾è®ºæµ…è°ˆä¹‹æœ€çŸ­è·¯</a></li> <li><a href="/docs/algorithm/Graph-segment_tree_scan">çº¿æ®µæ ‘ä¹‹æ‰«æçº¿æµ…è°ˆ</a></li> <li class="divider"> <li><a href="/docs/algorithm/Math-1">ç®—æ³•ç«èµ›ç®€å•æ•°è®ºçŸ¥è¯†(ä¸€)</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-math">æ•°å­¦ç¬”è®° <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a>ğŸ¦‰å³å°†ä¸Šçº¿</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-ai">AIç¬”è®° <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a>ğŸ¦‰å³å°†ä¸Šçº¿</a></li> </ul> </li> </ul> <ul class="nav navbar-nav navbar-right visible-lg-block"> </ul> </div> </div> </nav> <div class="container" role="main"> <div class="row"> <div class="col-lg-3 col-md-4 visible-lg-block visible-md-block custom-no-padding"> <div class="custom-fixed-sidebar"> <div id="toc"></div> </div> </div> <div class="col-lg-9 col-md-8 custom-bg-white"> <div class="row"> <div class="col-md-12 custom-article"> <p class="text-right pull-right visible-lg-block hidden-print small custom-pt25"> <a href="//github.com/mooyyu" target="_blank" data-toggle="tooltip" data-placement="bottom" title="Visit mooyyu's profile on Github"><img class="avatar avatar-small" alt="mooyyu" width="30" height="30" data-proofer-ignore="true" src="https://avatars3.githubusercontent.com/mooyyu?v=3&s=30" srcset="https://avatars3.githubusercontent.com/mooyyu?v=3&s=30 1x, https://avatars3.githubusercontent.com/mooyyu?v=3&s=60 2x, https://avatars3.githubusercontent.com/mooyyu?v=3&s=90 3x, https://avatars3.githubusercontent.com/mooyyu?v=3&s=120 4x"></a> </p> <h1 class="custom-article-header">çº¿æ®µæ ‘ä¹‹æ‰«æçº¿æµ…è°ˆ</h1> <p class="small"> çº¿æ®µæ ‘çš„å¸¸è§åº”ç”¨ä¹‹ä¸€ </p> <div class="panel panel-info">
<div class="panel-heading"><h4 class="panel-title">
<i class="fa fa-info-circle pull-left" aria-hidden="true"></i>Information</h4></div>
<div class="panel-body">
<p> </p>
<p>This doc has been marked <code class="language-plaintext highlighter-rouge">needs-review</code>. Following information are in upcoming update plan.</p> </div>
</div> <ul> <li>çº¿æ®µæ ‘</li> <li>ç¦»æ•£åŒ–</li> </ul> <h2 id="å¹³è¡ŒçŸ©é˜µç¾¤è¦†ç›–åŒºåŸŸçš„é¢ç§¯">å¹³è¡ŒçŸ©é˜µç¾¤è¦†ç›–åŒºåŸŸçš„é¢ç§¯</h2> <p><img src="/assets/images/algorithm/Graph-segment_tree_scan/scanline.svg" alt="æ‰«æçº¿"></p> <ul> <li>ç¦»æ•£åŒ–xè½´åæ ‡ç”Ÿæˆa+1ä¸ªåæ ‡</li> <li>åœ¨ç¦»æ•£åŒ–çš„xè½´çš„aä¸ªåæ ‡é—´éš”ä¸Šå»ºç«‹çº¿æ®µæ ‘ <ul> <li>åŒºé—´ä¿®æ”¹è¦†ç›–è®¡æ•°+1-1</li> <li>åŒºé—´æŸ¥è¯¢çš„æ„ä¹‰ï¼šè¦†ç›–è®¡æ•°å¤§äº0çš„é—´éš”é•¿åº¦å’Œ</li> </ul> </li> <li>å°†nä¸ªçŸ©é˜µåŒ–ä¸º2nä¸ª4å…ƒç»„(l, r, y, flag)å¹¶æ’åº</li> <li>æ‰«æçº¿åœ¨æ’å¥½åºçš„2nä¸ªå…ƒç»„ä¸Šå‰è¿› <ul> <li>æ ¹æ®å½“å‰å…ƒç»„çš„flagç¡®å®šåŒºé—´(l, r)ä¿®æ”¹çš„åŠ å‡</li> <li>è¦†ç›–é¢ç§¯å¢åŠ ï¼šquery * æ‰«æçº¿å‰è¿›è·ç¦»</li> </ul> </li> <li>å¯¹çº¿æ®µæ ‘æ“ä½œçš„ç‰¹æ®Šæ€§ï¼šæŸ¥è¯¢æ“ä½œä»…è¿›è¡Œå…¨åŒºé—´æŸ¥è¯¢</li> </ul> <p><img src="/assets/images/algorithm/Graph-segment_tree_scan/segment_tree.svg" alt="çº¿æ®µæ ‘"></p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;cstdio&gt;
#include &lt;set&gt;
#include &lt;unordered_map&gt;
#include &lt;vector&gt;
#include &lt;algorithm&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">maxn</span> <span class="o">=</span> <span class="mf">1e4</span><span class="p">;</span>
<span class="n">set</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">si</span><span class="p">;</span>
<span class="n">vector</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">vi</span><span class="p">;</span>
<span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">uti</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">node</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">flag</span><span class="p">;</span>
	<span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">node</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">node</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span> <span class="n">sline</span><span class="p">[</span><span class="n">maxn</span> <span class="o">&lt;&lt;</span> <span class="mi">1u</span><span class="p">];</span>

<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">discrete</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">vi</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">si</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span> <span class="o">&amp;</span><span class="n">x</span> <span class="o">:</span> <span class="n">si</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">uti</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="o">++</span><span class="n">i</span><span class="p">;</span>
		<span class="n">vi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">SegTree</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="nc">node</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">cnt</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">tr</span><span class="p">[</span><span class="n">maxn</span> <span class="o">&lt;&lt;</span> <span class="mi">1u</span> <span class="o">&lt;&lt;</span> <span class="mi">2u</span><span class="p">];</span>
	<span class="kt">void</span> <span class="n">pushup</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">v</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1u</span><span class="p">].</span><span class="n">v</span> <span class="o">+</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1u</span> <span class="o">|</span> <span class="mi">1u</span><span class="p">].</span><span class="n">v</span><span class="p">;</span> <span class="p">}</span>
	<span class="kt">void</span> <span class="n">build</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">};</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
		<span class="n">build</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">);</span>
		<span class="n">build</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1u</span> <span class="o">|</span> <span class="mi">1u</span><span class="p">,</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="n">modify</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">flag</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="n">r</span> <span class="o">||</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">cnt</span> <span class="o">+=</span> <span class="n">flag</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">cnt</span><span class="p">)</span> <span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">v</span> <span class="o">=</span> <span class="n">vi</span><span class="p">[</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">r</span><span class="p">]</span> <span class="o">-</span> <span class="n">vi</span><span class="p">[</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">l</span><span class="p">];</span>
			<span class="k">else</span> <span class="n">pushup</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">modify</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">flag</span><span class="p">);</span>
			<span class="n">modify</span><span class="p">(</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="mi">1u</span> <span class="o">|</span> <span class="mi">1u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">flag</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">tr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">cnt</span><span class="p">)</span> <span class="n">pushup</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="nl">public:</span>
	<span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span> <span class="n">build</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="p">}</span>
	<span class="kt">int</span> <span class="n">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">flag</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">modify</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">flag</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">tr</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">v</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span> <span class="n">st</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

	<span class="kt">int</span> <span class="n">n</span> <span class="p">{};</span>
	<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">static</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">d</span><span class="p">;</span>
		<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">l</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">r</span> <span class="o">&gt;&gt;</span> <span class="n">d</span><span class="p">;</span>
		<span class="n">si</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">si</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
		<span class="n">sline</span><span class="p">[</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">1u</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="mi">1</span><span class="p">};</span>
		<span class="n">sline</span><span class="p">[</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">1u</span> <span class="o">|</span> <span class="mi">1u</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">};</span>
	<span class="p">}</span>
	<span class="n">discrete</span><span class="p">();</span>
	<span class="n">sort</span><span class="p">(</span><span class="n">sline</span><span class="p">,</span> <span class="n">sline</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">1u</span><span class="p">));</span>
	<span class="n">st</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">si</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">len</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">1u</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ret</span> <span class="o">+=</span> <span class="n">st</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="n">uti</span><span class="p">[</span><span class="n">sline</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">l</span><span class="p">],</span> <span class="n">uti</span><span class="p">[</span><span class="n">sline</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">r</span><span class="p">],</span> <span class="n">sline</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">flag</span><span class="p">)</span>
			   <span class="o">*</span> <span class="p">(</span><span class="n">sline</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="n">y</span> <span class="o">-</span> <span class="n">sline</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ret</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="æ­¤æ¨¡å‹çš„ç®€å•æ‹“å±•">æ­¤æ¨¡å‹çš„ç®€å•æ‹“å±•</h3> <ul> <li> <p>æ±‚å„çŸ©é˜µä¸å…¶ä»–çŸ©é˜µé‡åˆé¢ç§¯ä¹‹å’Œ</p> <p>å„çŸ©é˜µé¢ç§¯ä¹‹å’Œå‡å»è¦†ç›–åŒºåŸŸé¢ç§¯å³å¯</p> </li> <li> <p>æ±‚è‡³å°‘è¢«ä¸¤ä¸ªçŸ©é˜µè¦†ç›–çš„åŒºåŸŸé¢ç§¯ã€ï¼ˆæˆ–å…¶ä»–ç±»ä¼¼æ¡ä»¶ï¼‰</p> <p>è¿™ç§æ¡ä»¶çš„æ”¹å˜ç›´æ¥å¯¹åº”åˆ°å¯¹cntçš„å€¼çš„åˆ¤æ–­å³å¯</p> </li> </ul> <h2 id="å¹³è¡ŒçŸ©é˜µç¾¤è¦†ç›–åŒºåŸŸçš„å‘¨é•¿">å¹³è¡ŒçŸ©é˜µç¾¤è¦†ç›–åŒºåŸŸçš„å‘¨é•¿</h2> </div> </div> </div> </div> </div> <footer> <div class="container"> <div class="row"> <div class="col-lg-8"> <p>Mooyyu Crab.'s Blog <i class="fa fa-heart text-danger" aria-hidden="true"></i>. Check out <a href="//github.com/mooyyu/mooyyu.github.io" target="_blank">Github Project <i class="fa fa-github-alt" aria-hidden="true"></i></a>.<br> The contents of this website are Â© 2021 under the terms of the <a href="//www.gnu.org/licenses/gpl-3.0.txt" target="_blank">GPLv3</a> License.</p> </div> <div class="col-lg-4"> <div class="pull-right"> <a href="#top" data-proofer-ignore> Back to top <i class="fa fa-level-up" aria-hidden="true"></i></a> </div> </div> </div> </div> </footer> <div style="width: 100%; overflow-x: hidden;"> <canvas class="fireworks" style="position:fixed;left:0;top:0;z-index:99999999;pointer-events:none;"></canvas> </div> <script>
  MathJax = {
    options: {
      enableMenu: false
    }
  };
</script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-svg.js"></script> <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-128176907-1', {
          'cookieDomain': 'mooyyu.github.io',
          'siteSpeedSampleRate': 80
      });

      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script> </body> </html>
