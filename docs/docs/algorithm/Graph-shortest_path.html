<!DOCTYPE html>
<html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="flattr:id" content="e7nqg5"> <title>å›¾è®ºæµ…è°ˆä¹‹æœ€çŸ­è·¯ | Mooyyu Crab.</title> <meta name="generator" content="Jekyll v3.9.0"> <meta property="og:title" content="å›¾è®ºæµ…è°ˆä¹‹æœ€çŸ­è·¯"> <meta name="author" content="mooyyu"> <meta property="og:locale" content="en_US"> <meta name="description" content="ä¼ ç»Ÿç®—æ³•ä¸­çš„æœ€çŸ­è·¯é—®é¢˜è§£è¯»"> <meta property="og:description" content="ä¼ ç»Ÿç®—æ³•ä¸­çš„æœ€çŸ­è·¯é—®é¢˜è§£è¯»"> <link rel="canonical" href="https://mooyyu.github.io/docs/algorithm/Graph-shortest_path.html"> <meta property="og:url" content="https://mooyyu.github.io/docs/algorithm/Graph-shortest_path.html"> <meta property="og:site_name" content="Mooyyu Crab."> <meta property="og:type" content="article"> <meta property="article:published_time" content="2020-03-15T00:00:00+00:00"> <script type="application/ld+json">
{"headline":"å›¾è®ºæµ…è°ˆä¹‹æœ€çŸ­è·¯","dateModified":"2020-03-15T00:00:00+00:00","datePublished":"2020-03-15T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mooyyu.github.io/docs/algorithm/Graph-shortest_path.html"},"author":{"@type":"Person","name":"mooyyu"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://mooyyu.github.io/assets/images/logo/mooyyu/m.png"},"name":"mooyyu"},"description":"ä¼ ç»Ÿç®—æ³•ä¸­çš„æœ€çŸ­è·¯é—®é¢˜è§£è¯»","url":"https://mooyyu.github.io/docs/algorithm/Graph-shortest_path.html","@type":"BlogPosting","@context":"https://schema.org"}</script> <link rel="icon" href="/assets/favicon.ico"> <link rel="stylesheet" href="/assets/stylesheets/main.css"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script><![endif]--> <script src="/assets/javascript/head.min.js"></script> <script type="text/javascript">

      /**
       * As Github pages do not support https for custom domains
       * this is the current best workaround for #18.
       */
      var domains  = [ 'mooyyu.github.io', 'localhost', '127.0.0.1' ];
      var pathname = location.pathname.replace(/^\/Mooyyu Crab.'s Github Page/, '')
      if (domains.indexOf(window.location.hostname) == -1)
        window.top.location.href = 'https://mooyyu.github.io' + pathname;

      /**
       * Another ugly workaround trying to improve UX reported by #35
       */
      if (location.protocol != 'https:' && window.location.hostname == 'mooyyu.github.io')
        location.href = 'https:' + window.location.href.substring(window.location.protocol.length);

      /**
       * Improves overall speed by loading javascript and css resources in parallel
       * with the main page.
       */
      head.load(
          "/assets/stylesheets/font-awesome.min.css",

          "/assets/javascript/jquery-2.2.1.min.js",
          "/assets/javascript/jquery-ui.min.js",
          "/assets/javascript/bootstrap.min.js",
          "/assets/javascript/tocify.min.js",
          "/assets/javascript/custom.js",

          "/assets/javascript/sheetrock.min.js",
          "/assets/javascript/cookieconsent.min.js",
          "/assets/javascript/pop.min.js"
      );

      head.ready(function() {
        window.cookieconsent_options = {
          "message":"This site use cookies to ensure you get the best experience on the website",
          "dismiss": "Got it!", "learnMore": "More info", "link":"", "theme": "dark-bottom"
        };
        $("body").on('click', '[data-stopPropagation]', function (e) {
          e.stopPropagation();
        });
      });
    </script> </head> <body role="document"> <nav class="navbar navbar-default navbar-fixed-top custom-no-margin"> <div class="container"> <div class="navbar-header"> <a href="/" class="navbar-brand" style="color: slategrey;"> Mooyyu Crab.'s Blog </a> <img id="daynite" src="/assets/images/btn-night.svg" alt="Dark Mode" width="32" height="32"> <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> </div> <div class="navbar-collapse collapse" id="navbar-main"> <ul class="nav navbar-nav"> <li><a href="/whoami/">WHO AM I? </a></li> <li class="dropdown siteindex"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-documentation">Site Index <span class="caret"></span></a> <ul class="dropdown-menu"> <li class="dropdown dropdown-submenu algorithm"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-stoppropagation="true" id="navbar-sub-algorithm">Algorithm</a> <ul class="dropdown-menu"> <li><a href="/meta/algorithm/"> All documents </a></li> <li class="divider"> <li><a href="/docs/algorithm/Math-1.html">ç®—æ³•ç«èµ›ç®€å•æ•°è®ºçŸ¥è¯†(ä¸€)</a></li> <li><a href="/docs/algorithm/DP-knapsack.html">åŠ¨æ€è§„åˆ’: èƒŒåŒ…é—®é¢˜ (ä¸€)</a></li> <li><a href="/docs/algorithm/Graph-shortest_path.html">å›¾è®ºæµ…è°ˆä¹‹æœ€çŸ­è·¯</a></li> <li><a href="/docs/algorithm/DP-linear.html">åŠ¨æ€è§„åˆ’å…¥é—¨ä¹‹çº¿æ€§æå€¼æ¨¡å‹</a></li> <li><a href="/docs/algorithm/DS-1.html">ç®—æ³•ç«èµ›ç®€å•æ•°æ®ç»“æ„(ä¸€)</a></li> <li><a href="/docs/algorithm/Graph-segment_tree_scan.html">çº¿æ®µæ ‘ä¹‹æ‰«æçº¿æµ…è°ˆ</a></li> <li><a href="/docs/algorithm/basic.html">åŸºç¡€ç®—æ³•æ‚è°ˆ</a></li> </ul> </li> <li class="dropdown dropdown-submenu oicode"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-stoppropagation="true" id="navbar-sub-oicode">OI-code</a> <ul class="dropdown-menu"> <li><a href="/meta/oicode/"> All documents </a></li> <li class="divider"> <li><a href="/docs/oicode/B1.html"><strong>B1</strong>: å‰ç¼€å’Œä¸å·®åˆ†</a></li> <li><a href="/docs/oicode/B2.html"><strong>B2</strong>: å¿«é€Ÿç»„åˆ</a></li> <li><a href="/docs/oicode/B3.html"><strong>B3</strong>: äºŒåˆ†æŸ¥æ‰¾</a></li> <li><a href="/docs/oicode/B4-add.html"><strong>B4</strong>: é«˜ç²¾åº¦åŠ æ³•</a></li> <li><a href="/docs/oicode/B4-div.html"><strong>B4</strong>: é«˜ç²¾åº¦é™¤æ³•</a></li> <li><a href="/docs/oicode/B4-multi.html"><strong>B4</strong>: é«˜ç²¾åº¦ä¹˜æ³•</a></li> <li><a href="/docs/oicode/B4-sub.html"><strong>B4</strong>: é«˜ç²¾åº¦å‡æ³•</a></li> <li><a href="/docs/oicode/D1.html"><strong>D1</strong>: å•è°ƒæ ˆ</a></li> <li><a href="/docs/oicode/D2.html"><strong>D2</strong>: å•è°ƒé˜Ÿåˆ—</a></li> <li><a href="/docs/oicode/D3.html"><strong>D3</strong>: Spare Table</a></li> <li><a href="/docs/oicode/D4.html"><strong>D4</strong>: å­—å…¸æ ‘</a></li> <li><a href="/docs/oicode/D5.html"><strong>D5</strong>: å¹¶æŸ¥é›†</a></li> <li><a href="/docs/oicode/D6-rc.html"><strong>D6</strong>: æ ‘çŠ¶æ•°ç»„-é™å®šåŒºé—´è®¡æ•°</a></li> <li><a href="/docs/oicode/D6-surs.html"><strong>D6</strong>: æ ‘çŠ¶æ•°ç»„-å•ç‚¹æ›´æ–°åŒºé—´æ±‚å’Œ</a></li> <li><a href="/docs/oicode/D7-basic.html"><strong>D7</strong>: çº¿æ®µæ ‘-åŸºç¡€</a></li> <li><a href="/docs/oicode/G1.html"><strong>G1</strong>: äºŒåˆ†å›¾-åˆ¤å®š</a></li> <li><a href="/docs/oicode/G2.html"><strong>G2</strong>: äºŒåˆ†å›¾-æœ€å¤§åŒ¹é…</a></li> <li><a href="/docs/oicode/G3.html"><strong>G3</strong>: Astar kçŸ­è·¯ on matrix</a></li> <li><a href="/docs/oicode/G4.html"><strong>G4</strong>: æ‹“æ‰‘æ’åº</a></li> <li><a href="/docs/oicode/G5.html"><strong>G5</strong>: è¿é€šæ— ç¯æ— å‘å›¾çš„é‡å¿ƒ</a></li> <li><a href="/docs/oicode/G6.html"><strong>G6</strong>: MST-Kruskal</a></li> <li><a href="/docs/oicode/G7.html"><strong>G7</strong>: MST-Prim</a></li> <li><a href="/docs/oicode/G8.html"><strong>G8</strong>: ShortestPath-BellmanFord</a></li> <li><a href="/docs/oicode/G9.html"><strong>G9</strong>: ShortestPath-Dijkstra</a></li> <li><a href="/docs/oicode/G9-hopt.html"><strong>G9</strong>: ShortestPath-Dijkstra Heap OPT</a></li> <li><a href="/docs/oicode/G10.html"><strong>G10</strong>: ShortestPath-SPFA</a></li> <li><a href="/docs/oicode/G11.html"><strong>G11</strong>: ShortestPath-Floyd</a></li> <li><a href="/docs/oicode/M1.html"><strong>M1</strong>: å¿«é€Ÿå¹‚ä¸é¾Ÿé€Ÿä¹˜</a></li> <li><a href="/docs/oicode/M2.html"><strong>M2</strong>: æ¬§å‡ é‡Œå¾—-æœ€å¤§å…¬çº¦æ•°</a></li> <li><a href="/docs/oicode/M2-ft.html"><strong>M2</strong>: EXæ¬§å‡ é‡Œå¾—-ç¿¡èœ€å®šç†</a></li> <li><a href="/docs/oicode/M2-lce.html"><strong>M2</strong>: EXæ¬§å‡ é‡Œå¾—-çº¿æ€§åŒä½™æ–¹ç¨‹</a></li> <li><a href="/docs/oicode/M2-mi.html"><strong>M2</strong>: EXæ¬§å‡ é‡Œå¾—-ä¹˜æ³•é€†å…ƒ</a></li> <li><a href="/docs/oicode/M3-flt.html"><strong>M3</strong>: è´¹é©¬å°å®šç†-ä¹˜æ³•é€†å…ƒ</a></li> <li><a href="/docs/oicode/M4.html"><strong>M4</strong>: åˆ†è§£è´¨å› æ•°</a></li> <li><a href="/docs/oicode/M4-euler.html"><strong>M4</strong>: åˆ†è§£è´¨å› æ•°-æ¬§æ‹‰å‡½æ•°</a></li> <li><a href="/docs/oicode/M4-prc.html"><strong>M4</strong>: åˆ†è§£è´¨å› æ•°-å¤šæ•°ä¹˜ç§¯çº¦æ•°è®¡æ•°</a></li> <li><a href="/docs/oicode/M4-prs.html"><strong>M4</strong>: åˆ†è§£è´¨å› æ•°-å¤šæ•°ä¹˜ç§¯çº¦æ•°æ±‚å’Œ</a></li> <li><a href="/docs/oicode/M5.html"><strong>M5</strong>: æ¬§æ‹‰ç­›</a></li> <li><a href="/docs/oicode/M5-ps.html"><strong>M5</strong>: æ¬§æ‹‰ç­›-è´¨æ•°ç­›</a></li> <li><a href="/docs/oicode/M6.html"><strong>M6</strong>: åŸƒæ°ç­›-è´¨æ•°ç­›</a></li> <li><a href="/docs/oicode/M7.html"><strong>M7</strong>: Steinç®—æ³•-æœ€å¤§å…¬çº¦æ•°</a></li> <li><a href="/docs/oicode/M8.html"><strong>M8</strong>: çŸ©é˜µä¹˜æ³•ä¸å¿«é€Ÿå¹‚</a></li> <li><a href="/docs/oicode/O1.html"><strong>O1</strong>: å¿«é€Ÿæ’åº</a></li> <li><a href="/docs/oicode/O2.html"><strong>O2</strong>: å¹¶å½’æ’åº</a></li> <li><a href="/docs/oicode/S1.html"><strong>S1</strong>: KMP</a></li> <li><a href="/docs/oicode/S2.html"><strong>S2</strong>: å­—ç¬¦ä¸²å“ˆå¸Œ</a></li> </ul> </li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-algorithm">ä¼ ç»Ÿç®—æ³• <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="/docs/algorithm/basic">åŸºç¡€ç®—æ³•æ‚è°ˆ</a></li> <li class="divider"> <li><a href="/docs/algorithm/DS-1">ç®—æ³•ç«èµ›ç®€å•æ•°æ®ç»“æ„(ä¸€)</a></li> <li class="divider"> <li><a href="/docs/algorithm/DP-knapsack">åŠ¨æ€è§„åˆ’:èƒŒåŒ…é—®é¢˜(ä¸€)</a></li> <li><a href="/docs/algorithm/DP-linear">åŠ¨æ€è§„åˆ’å…¥é—¨ä¹‹çº¿æ€§æå€¼æ¨¡å‹</a></li> <li class="divider"> <li><a href="/docs/algorithm/Graph-shortest_path">å›¾è®ºæµ…è°ˆä¹‹æœ€çŸ­è·¯</a></li> <li><a href="/docs/algorithm/Graph-segment_tree_scan">çº¿æ®µæ ‘ä¹‹æ‰«æçº¿æµ…è°ˆ</a></li> <li class="divider"> <li><a href="/docs/algorithm/Math-1">ç®—æ³•ç«èµ›ç®€å•æ•°è®ºçŸ¥è¯†(ä¸€)</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-math">æ•°å­¦ç¬”è®° <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a>ğŸ¦‰å³å°†ä¸Šçº¿</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-ai">AIç¬”è®° <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a>ğŸ¦‰å³å°†ä¸Šçº¿</a></li> </ul> </li> </ul> <ul class="nav navbar-nav navbar-right visible-lg-block"> </ul> </div> </div> </nav> <div class="container" role="main"> <div class="row"> <div class="col-lg-3 col-md-4 visible-lg-block visible-md-block custom-no-padding"> <div class="custom-fixed-sidebar"> <div id="toc"></div> </div> </div> <div class="col-lg-9 col-md-8 custom-bg-white"> <div class="row"> <div class="col-md-12 custom-article"> <p class="text-right pull-right visible-lg-block hidden-print small custom-pt25"> <a href="//github.com/mooyyu" target="_blank" data-toggle="tooltip" data-placement="bottom" title="Visit mooyyu's profile on Github"><img class="avatar avatar-small" alt="mooyyu" width="30" height="30" data-proofer-ignore="true" src="https://avatars3.githubusercontent.com/mooyyu?v=3&s=30" srcset="https://avatars3.githubusercontent.com/mooyyu?v=3&s=30 1x, https://avatars3.githubusercontent.com/mooyyu?v=3&s=60 2x, https://avatars3.githubusercontent.com/mooyyu?v=3&s=90 3x, https://avatars3.githubusercontent.com/mooyyu?v=3&s=120 4x"></a> </p> <h1 class="custom-article-header">å›¾è®ºæµ…è°ˆä¹‹æœ€çŸ­è·¯</h1> <p class="text-right pull-right small">15 March 2020</p> <p class="small"> ä¼ ç»Ÿç®—æ³•ä¸­çš„æœ€çŸ­è·¯é—®é¢˜è§£è¯» </p> <p>æœ€çŸ­è·¯é—®é¢˜æ˜¯ä¼ ç»Ÿç®—æ³•ç«èµ›ä¸­å›¾è®ºçš„æœ€å¸¸è€ƒå¯Ÿçš„é—®é¢˜ï¼Œä¹Ÿæ˜¯å†…å®¹ç›¸å¯¹å¤šçš„éƒ¨åˆ†ã€‚æœ¬æ–‡è¯¦ç»†è®¨è®ºæœ€çŸ­è·¯çš„å„åŸºç¡€ç®—æ³•ä»¥åŠå¸¸ç”¨çš„æœ€çŸ­è·¯æ¨¡å‹å’Œæ‹“å±•ã€‚æœ¬æ–‡åå‘äºåº”ç”¨ä¸ç»†èŠ‚è€ŒéåŸç†ã€‚</p> <hr> <h2 id="æœ¬æ–‡ä¸»è¦å†…å®¹">æœ¬æ–‡ä¸»è¦å†…å®¹</h2> <ul> <li>æœ¬æ–‡ä¸­æœ€çŸ­è·¯ç”¨åˆ°çš„å¸¸ç”¨æœ¯è¯­</li> <li>å…¨æºå…¨æ±‡æœ€çŸ­è·¯ä¸Floydç®—æ³•</li> <li>å•æºæœ€çŸ­è·¯ <ul> <li>å¸¦æƒæœ€çŸ­è·¯ä¸‹çš„åŸºç¡€ç®—æ³• <ul> <li>å¸¦æƒæœ€çŸ­è·¯é—®é¢˜å›¾çš„å­˜å‚¨æ–¹æ³•å’Œæ³¨æ„äº‹é¡¹</li> <li>é€‚ç”¨ç¨ å¯†æ­£æƒå›¾çš„æœ´ç´ çš„Dijkstraç®—æ³•</li> <li>é€‚ç”¨ç¨€ç–æ­£æƒå›¾çš„å †ä¼˜åŒ–çš„Dijkstraç®—æ³•</li> <li>SPFAç®—æ³•</li> </ul> </li> <li>å„ç®—æ³•çš„å…¨æ±‡æœ€çŸ­è·¯ä¸å•æ±‡æœ€çŸ­è·¯</li> <li>BFSé€‚ç”¨çš„æœ€çŸ­è·¯é—®é¢˜ <ul> <li>BFSå¦‚ä½•æ±‚è§£ç‰¹å®šçš„æœ€çŸ­è·¯é—®é¢˜</li> <li>BFSé€‚ç”¨çš„æœ€çŸ­è·¯æ¨¡å‹ <ul> <li>æœ€å°æ­¥æ•°æ¨¡å‹</li> <li>æœ€å°‘è½¬æ¢æ¨¡å‹ <ul> <li>ä½¿ç”¨åŒå‘BFSç®—æ³•ä¼˜åŒ–</li> <li>ä½¿ç”¨A*ç®—æ³•ä¼˜åŒ–</li> </ul> </li> </ul> </li> </ul> </li> <li>å•æºæœ€çŸ­è·¯çš„å„ç§æ‹“å±• <ul> <li>è¾¹æ•°é™åˆ¶ä¸ºkçš„æœ€çŸ­è·¯ä¸Bellman-Fordç®—æ³•</li> <li>å¤šä¸ªå¯é€‰æºç‚¹æœ€çŸ­è·¯</li> <li>æ­£æƒå›¾ä¸Šçš„æ¬¡çŸ­è·¯ä¸Dijkstraç®—æ³•</li> <li>kçŸ­è·¯ä¸A*ç®—æ³•</li> <li>ç»´æŠ¤è·¯å¾„æœ€çŸ­è·¯ <ul> <li>æœ€å°å­—å…¸åºè·¯å¾„</li> <li>æ‰€æœ‰è·¯å¾„</li> </ul> </li> </ul> </li> </ul> </li> <li>å…¶ä»– <ul> <li>SPFAç®—æ³•ä¸åˆ¤æ–­è´Ÿç¯</li> </ul> </li> </ul> <h2 id="æœ¬æ–‡ä¸­æœ€çŸ­è·¯ç”¨åˆ°çš„å¸¸ç”¨æœ¯è¯­">æœ¬æ–‡ä¸­æœ€çŸ­è·¯ç”¨åˆ°çš„å¸¸ç”¨æœ¯è¯­</h2> <table> <thead> <tr> <th style="text-align: right">æœ¯è¯­</th> <th>å«ä¹‰</th> <th>è¡¨ç¤º</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">æºç‚¹ã€æ±‡ç‚¹</td> <td>å¯¹äºä¸€æ¡æœ€çŸ­è·¯çš„èµ·ç‚¹ã€ç»ˆç‚¹</td> <td>\(sourceã€sink\)</td> </tr> <tr> <td style="text-align: right">æœ€çŸ­è·ç¦»</td> <td>ç‚¹\(i\)åˆ°ç‚¹\(j\)çš„æœ€çŸ­è·ç¦»ã€æºç‚¹åˆ°ç‚¹\(k\)çš„æœ€çŸ­è·ç¦»</td> <td>\(d(i, j)ã€dis(k)\)</td> </tr> <tr> <td style="text-align: right">ä¸‰è§’ä¸ç­‰å¼</td> <td>ä»ç‚¹\(i\) åˆ°\(j\) çš„ç›´æ¥è·ç¦»ä¸ä¼šå¤§äºé€”ç»çš„ä»»ä½•å…¶å®ƒç‚¹\(k\)çš„è·ç¦»</td> <td>\(d(i, j)\leqslant d(i, k) + d(k, j)\)</td> </tr> <tr> <td style="text-align: right">æ¾å¼›æ“ä½œ</td> <td>åˆ©ç”¨ä¸‰è§’ä¸ç­‰å¼ï¼Œä½¿ç”¨ä¸­é—´ç‚¹\(k\)æ›´æ–°ç‚¹\(i\)åˆ°\(j\)çš„ç›´æ¥è·ç¦»ï¼Œä¸€èˆ¬\(i\)æŒ‡æºç‚¹</td> <td>\(relax(k, j)\)</td> </tr> <tr> <td style="text-align: right">ä¸è¿é€š</td> <td>ä½¿ç”¨ä¸€ä¸ªç›¸å¯¹äºå›¾ä¸­æ•°æ®å¤§å¾ˆå¤šçš„å€¼ä½œä¸ºä¸¤ç‚¹é—´è·ç¦»è¡¨ç¤ºä¸è¿é€š</td> <td>\(INF\)</td> </tr> <tr> <td style="text-align: right">èŠ‚ç‚¹é›†ã€è¾¹é›†</td> <td>æ„æˆå›¾çš„æ‰€æœ‰èŠ‚ç‚¹çš„é›†åˆã€è¾¹çš„é›†åˆ</td> <td>\(Vertexã€Edge\)</td> </tr> <tr> <td style="text-align: right">å‡ºç‚¹ã€å…¥ç‚¹</td> <td>å¯¹äºä¸€æ¡æœ‰å‘è¾¹çš„æŒ‡å‡ºç‚¹ã€æŒ‡å‘ç‚¹</td> <td>\(eã€u\)</td> </tr> </tbody> </table> <h2 id="å…¨æºå…¨æ±‡æœ€çŸ­è·¯ä¸floydç®—æ³•">å…¨æºå…¨æ±‡æœ€çŸ­è·¯ä¸Floydç®—æ³•</h2> <p>Floydç®—æ³•æ˜¯ä¸€ä¸ªå¾ˆä¼˜ç¾çš„ç®—æ³•ï¼Œå¯ä»¥æ±‚è§£ä»»æ„èµ·ç‚¹è‡³ä»»æ„ç»ˆç‚¹çš„æœ€çŸ­è·¯ã€‚è¿ç”¨äº†åŠ¨æ€è§„åˆ’çš„æ€æƒ³ã€‚</p> \[\begin{aligned} definition&amp;\\ &amp;f(i, j)\text{ express the shortest length of the path from point i to point j}\\ &amp;dis(i, j)\text{ express the length of the path from point i to point j}\\ request&amp;\\ &amp;\forall i, j\in Vertex, f(i, j)\\ state\ trasition&amp;\\ &amp;f(i, j) = \begin{cases} f(i, j)\\ \{f(i, k) + f(k, j)\mid k\in Vertex\} \end{cases}\\ &amp;state\ division:\quad f(i, j)\text{ is unrelaxed or releaxed by point k}\\ optimization&amp;\\ &amp;none\\ solution&amp;\\ &amp;loop\quad k\ in\ Vertex\\ &amp;\hphantom{loop\quad}loop\quad i\ in\ Vertex\\ &amp;\hphantom{loop\quad loop\quad}loop\quad j\ in\ Vertex\\ &amp;\hphantom{loop\quad loop\quad loop\quad}relax(k, j)\ about\ i\\ \end{aligned}\] <p>Floydç®—æ³•æ±‚è§£å…¨æºå…¨æ±‡æœ€çŸ­è·¯çš„ç»†èŠ‚æ³¨æ„ç‚¹</p> <ul> <li>ç”±äºæ±‚è§£çš„æ˜¯ä»»æ„ä¸¤ç‚¹é—´çš„æœ€çŸ­è·¯ï¼Œæ‰€ä»¥é€‚åˆä½¿ç”¨é‚»æ¥çŸ©é˜µå­˜å‚¨å›¾çš„ç»“æ„</li> <li>æ±‚è§£å‰æ„å›¾çš„è¿‡ç¨‹åˆ†ä¸ºåˆå§‹åŒ–ä¸è¾“å…¥ <ul> <li>åˆå§‹åŒ–æ—¶æ³¨æ„\(d(i, j)\begin{cases} INF,&amp;i\not = j\\0,&amp;i = j \end{cases}\)ï¼Œä¸ºä¸‹é¢çš„è¾“å…¥å»é‡åšå‡†å¤‡</li> <li>ç”±äºé‚»æ¥çŸ©é˜µç»“æ„ä¸­ä¸¤ç‚¹é—´ä»…èƒ½å­˜å‚¨ä¸€ä¸ªè·ç¦»ï¼Œæ‰€ä»¥è¾“å…¥è¦å¤„ç†é‡è¾¹é—®é¢˜</li> </ul> </li> <li>ç”±äºåœ¨è´Ÿæƒå›¾ä¸­\(INF\)å¯ä»¥è¢«è´Ÿæƒè¾¹æ¾å¼›æˆåŠŸï¼Œæ‰€ä»¥è¦æå‰åˆ¤æ–­\(d(i, k)\)å’Œ\(d(k, j)\)ä¸æ˜¯\(INF\)</li> </ul> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">type</span> <span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">FP</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
<span class="nl">public:</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">INF</span> <span class="o">=</span> <span class="n">numeric_limits</span><span class="o">&lt;</span> <span class="n">type</span> <span class="o">&gt;::</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ar</span><span class="p">[</span><span class="n">maxn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">maxn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="k">explicit</span> <span class="n">FP</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span> <span class="n">n</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">fill</span><span class="p">(</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">INF</span><span class="p">);</span>
			<span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="n">solve</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="n">INF</span><span class="p">)</span>
					<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
						<span class="k">if</span> <span class="p">(</span><span class="n">ar</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">INF</span><span class="p">)</span>
							<span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">ar</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div> <h2 id="å•æºæœ€çŸ­è·¯">å•æºæœ€çŸ­è·¯</h2> <p>å•æºæœ€çŸ­è·¯æ˜¯æœ€çŸ­è·¯é—®é¢˜ä¸­å†…å®¹æœ€å¤šï¼Œè€ƒå¯Ÿæœ€å¤šæœ€æ‚çš„éƒ¨åˆ†ã€‚å¯ä»¥åˆ†ä¸ºå¸¦æƒå•æºæœ€çŸ­è·¯ã€BFSé€‚ç”¨çš„æœ€çŸ­è·¯é—®é¢˜ä»¥åŠä»¥ä»–ä»¬ä¸ºåŸºç¡€è¿›è¡Œæ‹“å±•çš„ç‰¹æ®Šé—®é¢˜ã€‚ä¸€èˆ¬è€ƒå¯Ÿæœ€å¤šçš„æ˜¯å•æºå•æ±‡æœ€çŸ­è·¯ï¼Œä½†å¤§éƒ¨åˆ†ç®—æ³•å¯æ±‚å•æºå…¨æ±‡æœ€çŸ­è·¯é—®é¢˜ï¼Œä¹Ÿæœ‰é’ˆå¯¹å•æ±‡è¿›è¡Œä¼˜åŒ–çš„æ–¹æ³•å’Œåªèƒ½æ±‚è§£å•æ±‡æœ€çŸ­è·¯é—®é¢˜çš„ç‰¹æ®Šç®—æ³•ã€‚</p> <h3 id="å¸¦æƒæœ€çŸ­è·¯çš„åŸºç¡€ç®—æ³•">å¸¦æƒæœ€çŸ­è·¯çš„åŸºç¡€ç®—æ³•</h3> <p>ä¸€èˆ¬å¯ä»¥æ±‚è§£å¸¦æƒå•æºæœ€çŸ­è·¯é—®é¢˜çš„ç®—æ³•æœ‰Dijkstraç®—æ³•åŠå…¶å †ä¼˜åŒ–çš„ç®—æ³•ã€Bellman-Fordç®—æ³•ä»¥åŠåŸºäºå…¶çš„SPFAç®—æ³•ã€‚ç”±äºä¸€èˆ¬é—®é¢˜ä¸­Bellman-Fordç®—æ³•ä¸å­˜åœ¨ä¼˜è¶Šæ€§ï¼Œæ•…è¿™é‡Œçœå»ï¼Œæ­¤ç®—æ³•å°†åœ¨åæ–‡çš„æ‹“å±•æœ€çŸ­è·¯é—®é¢˜ä¸­è®²åˆ°ã€‚</p> <p>å¯¹äºå„æœ€çŸ­è·¯ç®—æ³•æˆ‘çš„åˆ†ææ€è·¯ä¸ºï¼šç¡®å®šä½¿ç”¨çš„æ•°æ®ç»“æ„(data structure)â€”â€”æ±‚è§£åˆå§‹åŒ–(initialization)â€”â€”æ ¸å¿ƒç®—æ³•(core algorithm)ï¼Œæˆ‘ç§°ä¹‹ä¸º\(DIC\)åˆ†ææ³•ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œå…ˆè¯´ä¸€è¯´æœ‰å…³å¸¦æƒå›¾å­˜å›¾çš„é—®é¢˜ã€‚</p> <h4 id="å¸¦æƒæœ€çŸ­è·¯é—®é¢˜å›¾çš„å­˜å‚¨æ–¹æ³•å’Œæ³¨æ„äº‹é¡¹">å¸¦æƒæœ€çŸ­è·¯é—®é¢˜å›¾çš„å­˜å‚¨æ–¹æ³•å’Œæ³¨æ„äº‹é¡¹</h4> <p>å¸¦æƒå›¾çš„å­˜å‚¨æ€»çš„æ¥è¯´æœ‰ä¸‰ç§ç»“æ„ï¼šè¾¹é›†ã€é‚»æ¥çŸ©é˜µå’Œé‚»æ¥è¡¨ã€‚è¾¹é›†è¾ƒä¸ºç®€å•ï¼Œä½¿ç”¨ç»“æ„ä½“æ•°ç»„å³å¯ã€‚é‚»æ¥çŸ©é˜µé€‚ç”¨äºç¨ å¯†å›¾ï¼Œé‚»æ¥è¡¨é€‚ç”¨äºç¨€ç–å›¾ã€‚å…¶ä¸­é‚»æ¥è¡¨æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼šå‘é‡\(vector\)å’Œé“¾å¼å‰å‘æ˜Ÿ<sup id="fnref:link_astar" role="doc-noteref"><a href="#fn:link_astar" class="footnote">1</a></sup>ï¼Œç”±äºå†…å­˜åˆ†é…çš„è€—æ—¶æ˜¯ä»…å’Œåˆ†é…æ¬¡æ•°æˆæ­£æ¯”çš„ï¼Œæ‰€ä»¥é“¾å¼å‰å‘æ˜Ÿå…·æœ‰ç»å¯¹ä¼˜åŠ¿ï¼Œåœ¨å›¾è®ºé—®é¢˜ä¸­éƒ½ä½¿ç”¨é“¾å¼å‰å‘æ˜Ÿå®ç°è¿æ¥è¡¨ã€‚</p> <p>é‚»æ¥çŸ©é˜µå­˜å›¾å­˜åœ¨å¦‚ä¸‹éœ€æ³¨æ„çš„äº‹é¡¹</p> <ul> <li>æ— æ³•å­˜å‚¨é‡è¾¹ï¼Œåªèƒ½åœ¨åˆå§‹åŒ–å’Œè¾“å…¥æ—¶å¤„ç†æ­¤é—®é¢˜ï¼Œå…¶ä¸­åˆå§‹åŒ–æ—¶\(d(i, j)\begin{cases} INF,&amp;i\not = j\\0,&amp;i = j \end{cases}\)</li> <li>å­˜å‚¨æ— å‘å›¾æ—¶ï¼Œè¦æŠŠæ¯æ¡æ— å‘è¾¹è½¬ä¸ºä¸¤æ¡å¯¹åº”çš„æœ‰å‘è¾¹</li> </ul> <p>é“¾å¼å‰å‘æ˜Ÿã€è¾¹é›†å­˜å›¾å­˜åœ¨å¦‚ä¸‹éœ€æ³¨æ„çš„äº‹é¡¹</p> <ul> <li>å­˜å‚¨æ— å‘å›¾æ—¶ï¼Œä¸ä»…è¦è½¬åŒ–è¾¹ï¼Œå­˜å‚¨ç©ºé—´ä¹Ÿéœ€è¦æ‰©å¤§ä¸€å€</li> </ul> <p>å„åŸºç¡€ç®—æ³•çš„å­˜å›¾ç»“æ„å¦‚ä¸‹ï¼š</p> <table> <thead> <tr> <th style="text-align: center">ç®—æ³•åç§°</th> <th style="text-align: center">å­˜å›¾ç»“æ„</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">é€‚ç”¨ç¨ å¯†å›¾çš„æœ´ç´ ç‰ˆDijkstraç®—æ³•</td> <td style="text-align: center">é‚»æ¥çŸ©é˜µ</td> </tr> <tr> <td style="text-align: center">é€‚ç”¨ç¨€ç–å›¾çš„å †ä¼˜åŒ–ç‰ˆDijkstraç®—æ³•</td> <td style="text-align: center">é“¾å¼å‰å‘æ˜Ÿ</td> </tr> <tr> <td style="text-align: center">SPFAç®—æ³•</td> <td style="text-align: center">é“¾å¼å‰å‘æ˜Ÿ</td> </tr> <tr> <td style="text-align: center">ç”¨äºæ±‚è§£ç¬¬kçŸ­è·¯çš„Bellman-Fordç®—æ³•</td> <td style="text-align: center">è¾¹é›†</td> </tr> </tbody> </table> <h4 id="é€‚ç”¨ç¨ å¯†æ­£æƒå›¾çš„æœ´ç´ çš„dijkstraç®—æ³•">é€‚ç”¨ç¨ å¯†æ­£æƒå›¾çš„æœ´ç´ çš„Dijkstraç®—æ³•</h4> <blockquote> <p>æ—¶é—´å¤æ‚åº¦ï¼š\(O(n^2)\)</p> <p>ä¸€å¥è¯æ ¸å¿ƒæ€æƒ³ï¼šæ¯æ¬¡é€‰å–ä½™ä¸‹çš„ç»“ç‚¹ä¸­æœ€è¿‘çš„ä¸€ä¸ªå°è¯•æ¾å¼›å…¶å‡ºè¾¹ã€‚</p> </blockquote> \[\begin{aligned} data\ structure&amp;\\ &amp;æ•°ç»„disï¼šæºç‚¹åˆ°å„ç‚¹çš„æœ€çŸ­è·¯å¾„\\ &amp;é›†åˆvisï¼šä¸æ»¡è¶³çŠ¶æ€ã€Œæœ€çŸ­è·¯ç¡®å®šï¼Œå‘åå®Œæˆæ¾å¼›æ“ä½œã€çš„ç»“ç‚¹çš„é›†åˆ\\ initialization&amp;\\ &amp;dis(e) = \begin{cases} INF,&amp;e \not = source\\ 0,&amp;e = source \end{cases}\\ &amp;push\ \forall e\in Vertex\ into\ vis\\ core\ algorithm&amp;\\ &amp;loop\quad n - 1\ times\\ &amp;\hphantom{loop\quad}find\ cur\in vis, \forall e\in vis,dis(cur)\leqslant dis(e)\\ &amp;\hphantom{loop\quad}delete\ cur\ from\ vis\\ &amp;\hphantom{loop\quad}relax(cur, u), u\in vis\\ \end{aligned}\] <p>æ³¨æ„ä¸Šè¿°è¿‡ç¨‹ä¸­\(cur\)ä»…å¯¹å±äºé›†åˆ\(vis\)çš„ç»“ç‚¹è¿›è¡Œæ¾å¼›ï¼Œå¹¶ä¸è¿èƒŒæ ¸å¿ƒæ€æƒ³ï¼Œå› ä¸ºå¯¹ä¸å±äºé›†åˆ\(vis\)çš„ç»“ç‚¹å°è¯•æ¾å¼›æ²¡æœ‰æ„ä¹‰ï¼ˆè¿™äº›ç»“ç‚¹çš„æœ€çŸ­è·¯å·²ç¡®å®šï¼‰ã€‚</p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">type</span> <span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">SPD_Dijkstra</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
	<span class="n">unordered_set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">vis</span><span class="p">;</span>
<span class="nl">public:</span>
	<span class="n">type</span> <span class="n">INF</span> <span class="o">=</span> <span class="n">numeric_limits</span><span class="o">&lt;</span><span class="n">type</span><span class="o">&gt;::</span><span class="n">max</span><span class="p">()</span><span class="o">&gt;&gt;</span><span class="mi">1u</span><span class="p">;</span>
	<span class="n">type</span> <span class="n">dis</span><span class="p">[</span><span class="n">maxn</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="n">type</span> <span class="n">ar</span><span class="p">[</span><span class="n">maxn</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">maxn</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="k">explicit</span> <span class="n">SPD_Dijkstra</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span> <span class="n">n</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">fill</span><span class="p">(</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">INF</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="n">solve</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">source</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">vis</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
		<span class="n">fill</span><span class="p">(</span><span class="n">dis</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dis</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">INF</span><span class="p">);</span>
		<span class="n">dis</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cur</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">cur</span> <span class="o">=</span> <span class="o">*</span><span class="n">vis</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
			<span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span> <span class="n">i</span> <span class="o">:</span> <span class="n">vis</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">dis</span><span class="p">[</span><span class="n">cur</span><span class="p">])</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
			<span class="n">vis</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">cur</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span> <span class="n">i</span> <span class="o">:</span> <span class="n">vis</span><span class="p">)</span> <span class="n">dis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dis</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span> <span class="o">+</span> <span class="n">ar</span><span class="p">[</span><span class="n">cur</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div> <h4 id="é€‚ç”¨ç¨€ç–æ­£æƒå›¾çš„å †ä¼˜åŒ–çš„dijkstraç®—æ³•">é€‚ç”¨ç¨€ç–æ­£æƒå›¾çš„å †ä¼˜åŒ–çš„Dijkstraç®—æ³•</h4> <p>å¯ä»¥æ³¨æ„åˆ°æœ´ç´ çš„Dijkstraç®—æ³•æœ‰ä¸¤ä¸ªåœ°æ–¹å¯ä»¥ä¼˜åŒ–</p> <ul> <li>ã€Œæ¯æ¬¡é€‰å–æœ€è¿‘çš„ç»“ç‚¹ã€è¿™ä¸€æ“ä½œå¯ä»¥å€ŸåŠ©å°æ ¹å †ç»´æŠ¤</li> <li>åªæœ‰å½“\(dis(cur)\)è¢«æ¾å¼›æˆåŠŸï¼Œ\(relax(cur, u)\)æ‰æœ‰æ„ä¹‰</li> </ul> <blockquote> <p>æ—¶é—´å¤æ‚åº¦ï¼š\(o(m\cdot \log n)\)</p> <p>æ ¸å¿ƒæ€æƒ³å’Œæœ´ç´ ç‰ˆç®—æ³•ç›¸åŒï¼Œåªæ˜¯å®ç°ä¸ŠåŠ äº†ä¸Šè¿°ä¸¤ä¸ªä¼˜åŒ–</p> </blockquote> \[\begin{aligned} data\ structure&amp;\\ &amp;æ•°ç»„disï¼šæºç‚¹åˆ°å„ç‚¹çš„æœ€çŸ­è·¯å¾„\\ &amp;é›†åˆvisï¼šä¸æ»¡è¶³çŠ¶æ€ã€Œæœ€çŸ­è·¯ç¡®å®šï¼Œå‘åå®Œæˆæ¾å¼›æ“ä½œã€çš„ç»“ç‚¹çš„é›†åˆ\\ &amp;å°æ ¹å †srpï¼š&lt;dis(e), e&gt;, e\in Vertex, compare\ by\ dis(e)\\ initialization&amp;\\ &amp;dis(e) = \begin{cases} INF,&amp;e \not = source\\ 0,&amp;e = source \end{cases}\\ &amp;push\ \forall e\in Vertex\ into\ vis\\ &amp;push\ source\ into\ srp\\ core\ algorithm&amp;\\ &amp;loop\quad untill\ srp\ is\ empty\\ &amp;\hphantom{loop\quad}pop\ cur\ from\ srp\\ &amp;\hphantom{loop\quad}if\quad cur\not\in vis\\ &amp;\hphantom{loop\quad if\quad}continue\ next\ loop\\ &amp;\hphantom{loop\quad}delete\ cur\ from\ vis\\ &amp;\hphantom{loop\quad}if\quad relax(cur, u), u\in vis\ is\ successful\\ &amp;\hphantom{loop\quad if\quad}push\ u\ into\ srp \end{aligned}\] <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">type</span> <span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">SPS_Dijkstra</span> <span class="p">{</span>
	<span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span> <span class="n">type</span><span class="p">,</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">pti</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
	<span class="kt">bool</span> <span class="n">vis</span><span class="p">[</span><span class="n">maxn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="n">priority_queue</span><span class="o">&lt;</span> <span class="n">pti</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span> <span class="n">pti</span> <span class="o">&gt;</span><span class="p">,</span> <span class="n">greater</span><span class="o">&lt;</span> <span class="n">pti</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">srp</span><span class="p">;</span>
<span class="nl">public:</span>
	<span class="k">struct</span> <span class="nc">node</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">to</span><span class="p">,</span> <span class="n">ptr</span><span class="p">;</span>
		<span class="n">type</span> <span class="n">len</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">ar</span><span class="p">[</span><span class="n">maxm</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">head</span><span class="p">[</span><span class="n">maxn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="k">const</span> <span class="n">type</span> <span class="n">INF</span> <span class="o">=</span> <span class="n">numeric_limits</span><span class="o">&lt;</span> <span class="n">type</span> <span class="o">&gt;::</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">;</span>
	<span class="n">type</span> <span class="n">dis</span><span class="p">[</span><span class="n">maxn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="k">explicit</span> <span class="n">SPS_Dijkstra</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="o">:</span> <span class="n">n</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{}</span>
	<span class="kt">void</span> <span class="n">solve</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">source</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">fill</span><span class="p">(</span><span class="n">dis</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dis</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">INF</span><span class="p">);</span>
		<span class="n">fill</span><span class="p">(</span><span class="n">vis</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">vis</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
		<span class="n">priority_queue</span><span class="o">&lt;</span> <span class="n">pti</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span> <span class="n">pti</span> <span class="o">&gt;</span><span class="p">,</span> <span class="n">greater</span><span class="o">&lt;</span> <span class="n">pti</span> <span class="o">&gt;</span> <span class="o">&gt;</span><span class="p">().</span><span class="n">swap</span><span class="p">(</span><span class="n">srp</span><span class="p">);</span>
		<span class="n">srp</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">source</span><span class="p">);</span>
		<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">srp</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
			<span class="k">static</span> <span class="kt">int</span> <span class="n">cur</span><span class="p">;</span>
			<span class="n">cur</span> <span class="o">=</span> <span class="n">srp</span><span class="p">.</span><span class="n">top</span><span class="p">().</span><span class="n">second</span><span class="p">,</span> <span class="n">srp</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">cur</span><span class="p">])</span> <span class="k">continue</span><span class="p">;</span>
			<span class="n">vis</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">cur</span><span class="p">];</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ptr</span><span class="p">)</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">])</span> <span class="p">{</span>
					<span class="k">static</span> <span class="n">type</span> <span class="n">dist</span><span class="p">;</span>
					<span class="k">if</span> <span class="p">((</span><span class="n">dist</span> <span class="o">=</span> <span class="n">dis</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span> <span class="o">+</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">len</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">dis</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">])</span>
						<span class="n">srp</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">,</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">);</span>
				<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div> <h4 id="spfaç®—æ³•">SPFAç®—æ³•</h4> <p>SPFAæ˜¯ä¸€ç§å¾ˆä¼˜ç§€çš„ç®—æ³•ï¼Œæ ¹æ®Bellman-Fordç®—æ³•å‘å±•è€Œæ¥ã€‚SPFAæœ‰SLF(shortest label first)å’ŒLLL(large label last)ä¸¤ç§ä¼˜åŒ–æ–¹æ³•ï¼Œä½†æ­¤ä¸¤ç§ä¼˜åŒ–ä¸å…·æœ‰æ™®é€‚æ€§ï¼Œä»…å¯¹ç‰¹æ®Šçš„å›¾èµ·åˆ°ä½œç”¨ï¼Œéœ€å…·ä½“åˆ†æï¼Œæ•…è¿™é‡Œä¸ä½œè®¨è®ºã€‚</p> <blockquote> <p>æ—¶é—´å¤æ‚åº¦ï¼šå¹³å‡\(O(m)\)ï¼Œæœ€å\(O(n\cdot m)\)</p> <p>ä¸€å¥è¯æ ¸å¿ƒæ€æƒ³ï¼šæ¯æ¬¡åœ¨æ–°çš„è¢«æ¾å¼›æˆåŠŸçš„èŠ‚ç‚¹ä¸­é€‰å–ä¸€ä¸ªå‘åå°è¯•æ¾å¼›å…¶å‡ºè¾¹ã€‚</p> </blockquote> \[\begin{aligned} data\ structure&amp;\\ &amp;æ•°ç»„disï¼šæºç‚¹åˆ°å„ç‚¹çš„æœ€çŸ­è·¯å¾„\\ &amp;é›†åˆvisï¼šæ»¡è¶³çŠ¶æ€ã€Œè¢«æ¾å¼›æˆåŠŸä½†å°šæœªå‘åè¿›è¡Œæ¾å¼›æ“ä½œã€çš„ç»“ç‚¹çš„é›†åˆ\\ &amp;é˜Ÿåˆ—queï¼š&lt;e&gt;, e\in Vertex\\ initialization&amp;\\ &amp;dis(e) = \begin{cases} INF,&amp;e \not = source\\ 0,&amp;e = source \end{cases}\\ &amp;push\ source\ into\ vis\\ &amp;push\ source\ into\ que\\ core\ algorithm&amp;\\ &amp;loop\quad untill\ que\ is\ empty\\ &amp;\hphantom{loop\quad}pop\ cur\ from\ que\\ &amp;\hphantom{loop\quad}delete\ cur\ from\ vis\\ &amp;\hphantom{loop\quad}if\quad relax(cur, u),u\in \{ cur's\ successors \}\ is\ successful\\ &amp;\hphantom{loop\quad if\quad}if\quad u\not\in vis\\ &amp;\hphantom{loop\quad if\quad if\quad}push\ u\ in\ vis\\ &amp;\hphantom{loop\quad if\quad if\quad}push\ u\ in\ que \end{aligned}\] <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">type</span> <span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">SP</span> <span class="p">{</span>
	<span class="n">type</span> <span class="n">dis</span><span class="p">[</span><span class="n">maxn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="kt">bool</span> <span class="n">vis</span><span class="p">[</span><span class="n">maxn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
	<span class="n">queue</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">que</span><span class="p">;</span>
<span class="nl">public:</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">INF</span> <span class="o">=</span> <span class="n">numeric_limits</span><span class="o">&lt;</span> <span class="n">type</span> <span class="o">&gt;::</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">;</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">to</span><span class="p">,</span> <span class="n">ptr</span><span class="p">;</span>
		<span class="n">type</span> <span class="n">len</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">ar</span><span class="p">[</span><span class="n">maxm</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="kt">int</span> <span class="n">head</span><span class="p">[</span><span class="n">maxn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="k">explicit</span> <span class="n">SP</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span> <span class="n">n</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{}</span>
	<span class="n">type</span> <span class="n">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">source</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">fill</span><span class="p">(</span><span class="n">vis</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">vis</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
		<span class="n">fill</span><span class="p">(</span><span class="n">dis</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dis</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">INF</span><span class="p">);</span>
		<span class="n">queue</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span><span class="p">().</span><span class="n">swap</span><span class="p">(</span><span class="n">que</span><span class="p">);</span>
		<span class="n">vis</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span> <span class="n">dis</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">que</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
		<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">que</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
			<span class="k">static</span> <span class="kt">int</span> <span class="n">cur</span><span class="p">;</span>
			<span class="n">cur</span> <span class="o">=</span> <span class="n">que</span><span class="p">.</span><span class="n">front</span><span class="p">(),</span> <span class="n">que</span><span class="p">.</span><span class="n">pop</span><span class="p">(),</span> <span class="n">vis</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">cur</span><span class="p">];</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ptr</span><span class="p">)</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span> <span class="o">+</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">len</span> <span class="o">&lt;</span> <span class="n">dis</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">])</span> <span class="p">{</span>
					<span class="n">dis</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">]</span> <span class="o">=</span> <span class="n">dis</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span> <span class="o">+</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">len</span><span class="p">;</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">])</span> <span class="p">{</span>
						<span class="n">que</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">);</span>
						<span class="n">vis</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div> <h3 id="å„ç®—æ³•çš„å…¨æ±‡æœ€çŸ­è·¯ä¸å•æ±‡æœ€çŸ­è·¯">å„ç®—æ³•çš„å…¨æ±‡æœ€çŸ­è·¯ä¸å•æ±‡æœ€çŸ­è·¯</h3> <p>ä¸Šè¿°çš„ä¸‰ç§ç®—æ³•ç»™å‡ºçš„ä¼ªç å’Œæ¨¡æ¿éƒ½æ˜¯ç”¨äºæ±‚è§£å•æºå…¨æ±‡æœ€çŸ­è·¯çš„ï¼Œå½“ç„¶å…¨æ±‡éƒ½å·²ç»æ±‚è§£å‡ºæ¥ï¼Œå¯¹äºç»™å®šçš„æ±‡ç‚¹ä¹Ÿæ˜¯å¾—åˆ°äº†ç­”æ¡ˆï¼Œä½†æ˜¯äº†è§£å„ç‚¹çš„æœ€çŸ­è·¯ç©¶ç«Ÿæ˜¯åœ¨ç®—æ³•çš„é‚£ä¸ªæ­¥éª¤æ±‚è§£å‡ºæ¥å¯¹äºæ·±å…¥ç†è§£ç®—æ³•æœ¬èº«å¾ˆæœ‰å¸®åŠ©ï¼Œæˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦åœ¨å¾—åˆ°ç»™å®šæ±‡ç‚¹çš„æœ€çŸ­è·¯ä¾¿åŠæ—¶é€€å‡ºã€‚åŒ…æ‹¬ä¸‹æ–‡çš„BFSã€A*æ±‚è§£æœ€çŸ­è·¯ï¼Œè¿™é‡Œä¸€èµ·è®¨è®ºä¸€ä¸‹ã€‚</p> <table> <thead> <tr> <th style="text-align: right">å…·ä½“ç®—æ³•</th> <th>ä½•æ—¶å¾—åˆ°è§£</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">Dijkstraç³»åˆ—ç®—æ³•</td> <td>å¯¹äºæ‰€æœ‰èŠ‚ç‚¹ï¼Œâ€œè¢«å¼¹å‡ºæ—¶â€å¾—åˆ°è§£ï¼Œå³è¢«ç¡®å®šä¸ºå½“å‰æœªç¡®å®šçš„ç»“ç‚¹ä¸­è·ç¦»æºç‚¹æœ€è¿‘æ—¶</td> </tr> <tr> <td style="text-align: right">Bellman-Fordã€SPFAç®—æ³•</td> <td>å¯¹äºæ‰€æœ‰èŠ‚ç‚¹ï¼Œâ€œç®—æ³•ç»“æŸæ—¶â€å¾—åˆ°è§£</td> </tr> <tr> <td style="text-align: right">BFSæ±‚è§£æœ€çŸ­è·¯é—®é¢˜</td> <td>å¯¹äºæ‰€æœ‰ç»“ç‚¹ï¼Œâ€œè¢«æ’å…¥æ—¶â€å¾—åˆ°è§£ï¼Œå³è¢«æ¾å¼›æˆåŠŸã€è¢«æ¢ç´¢åˆ°æ—¶</td> </tr> <tr> <td style="text-align: right">A*ç®—æ³•</td> <td>å¯¹äºä¸”ä»…å¯¹äºç»™å®šæ±‡ç‚¹ï¼Œâ€œç¬¬kæ¬¡å¼¹å‡ºæ—¶â€å¾—åˆ°â€œç¬¬kçŸ­è·¯â€çš„è§£</td> </tr> </tbody> </table> <h3 id="bfsé€‚ç”¨çš„æœ€çŸ­è·¯é—®é¢˜">BFSé€‚ç”¨çš„æœ€çŸ­è·¯é—®é¢˜</h3> <p>BFSæ˜¯å¯ä»¥æ±‚è§£æ— æƒæœ€çŸ­è·¯å’Œ01æƒå€¼æœ€çŸ­è·¯é—®é¢˜çš„ã€‚å› ä¸ºBFSæ˜¯æ»¡è¶³â€œæœ€å°æ€§â€çš„æœç´¢ï¼Œæ•…å¯ä»¥æ±‚è§£ã€‚ä¸‹é¢è¯¦ç»†è®¨è®ºã€‚</p> <h4 id="bfså¦‚ä½•æ±‚è§£ç‰¹å®šçš„æœ€çŸ­è·¯é—®é¢˜">BFSå¦‚ä½•æ±‚è§£ç‰¹å®šçš„æœ€çŸ­è·¯é—®é¢˜</h4> <p>é¦–å…ˆBFSæœç´¢çš„â€œæœ€å°æ€§â€æ˜¯å¦‚ä½•è¢«æ»¡è¶³çš„ï¼ŸBFSæ‰€ç»´æŠ¤çš„æ•°æ®ç»“æ„æ˜¯é˜Ÿåˆ—ï¼Œå¦‚æœç”¨\(x\)è¡¨ç¤ºæœç´¢è¿‡ç¨‹ä¸­ç¬¬\(x\)æ­¥æ¢ç´¢åˆ°çš„ç»“ç‚¹ï¼Œé‚£ä¹ˆç›´è§‚çš„ï¼Œä»»æ„æ—¶åˆ»é˜Ÿåˆ—éƒ½æ»¡è¶³å¦‚ä¸‹å½¢å¼ï¼š \(\{ \underbrace{x, x, x,\cdots}_{cnt(x)\geqslant 0}, \underbrace{\cdots,x + 1, x + 1, x + 1}_{cnt(x + 1)\geqslant 0} \}\) å¯ä»¥ç§°è¿™ç§æ€§è´¨ä¸ºâ€œä¸¤æ®µæ€§â€ï¼Œå‰ä¸€æ®µå°äºåä¸€æ®µï¼Œä¹Ÿå³ä»»æ„æ—¶åˆ»é˜Ÿåˆ—æ˜¯æ»¡è¶³å•è°ƒæ€§çš„ï¼Œæ•…å¯¹äºæ— æƒæœ€çŸ­è·¯å½“ç¬¬ä¸€æ¬¡æœç´¢åˆ°æ±‡ç‚¹æ—¶ï¼Œä¸€å®šç»å†äº†æœ€çŸ­çš„æ­¥æ•°ã€‚</p> <p>é‚£ä¹ˆå¯¹äº01æƒå€¼æœ€çŸ­è·¯ï¼Œæˆ‘ä»¬åªè¦æƒ³åŠæ³•ä¿è¯ç»´æŠ¤æ•°æ®ç»“æ„çš„å•è°ƒæ€§ï¼Œå°±ä¾æ—§å¯è§£ã€‚æ–¹æ³•æ˜¯ä½¿ç”¨åŒç«¯é˜Ÿåˆ—ä»£æ›¿æ™®é€šé˜Ÿåˆ—ï¼Œå½“æ¢ç´¢æƒå€¼ä¸º0çš„è¾¹æ—¶ï¼Œå°†èŠ‚ç‚¹æ’å…¥é˜Ÿé¦–å°±å¯ä¿è¯å…¶ä¸¤æ®µæ€§ï¼Œè¿›ä¸€æ­¥ä¿è¯äº†å•è°ƒæ€§å’Œæ­£ç¡®æ€§ã€‚</p> <p>ç»§ç»­æ€è€ƒä¸‹å»çš„è¯ï¼Œå¦‚æœæ˜¯å¤šæƒå€¼è¿˜æƒ³è¦ä¿è¯æ•°æ®ç»“æ„çš„å•è°ƒæ€§ï¼Œå°±éœ€è¦å †äº†ï¼Œæ­¤æ—¶BFSå°±å¼±åŒ–ä¸ºDijkstraç®—æ³•äº†ã€‚</p> <table> <thead> <tr> <th style="text-align: right">Â </th> <th style="text-align: center">æ™®é€šBFS</th> <th style="text-align: center">åŒç«¯é˜Ÿåˆ—ç»´æŠ¤çš„BFS</th> <th style="text-align: center">Dijkstra</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">è¾¹æƒ</td> <td style="text-align: center">1</td> <td style="text-align: center">0ã€1</td> <td style="text-align: center">éè´Ÿ</td> </tr> <tr> <td style="text-align: right">æœ€çŸ­è·¯ä½•æ—¶ç¡®å®š</td> <td style="text-align: center">è¢«æ¢ç´¢åˆ°æ—¶</td> <td style="text-align: center">è¢«ç”¨äºæ¢ç´¢æ—¶</td> <td style="text-align: center">è¢«ç”¨äºæ¢ç´¢æ—¶</td> </tr> <tr> <td style="text-align: right">æ•°æ®ç»“æ„</td> <td style="text-align: center">æ™®é€šé˜Ÿåˆ—</td> <td style="text-align: center">åŒç«¯é˜Ÿåˆ—</td> <td style="text-align: center">å°æ ¹å †</td> </tr> <tr> <td style="text-align: right">å„èŠ‚ç‚¹æ’å…¥çš„æ¬¡æ•°</td> <td style="text-align: center">ä¸å¤§äº1</td> <td style="text-align: center">ä¸å¤§äº2</td> <td style="text-align: center">å°äºæ€»ç»“ç‚¹æ•°</td> </tr> </tbody> </table> <h4 id="bfsé€‚ç”¨çš„æœ€çŸ­è·¯æ¨¡å‹">BFSé€‚ç”¨çš„æœ€çŸ­è·¯æ¨¡å‹</h4> <h5 id="æœ€å°æ­¥æ•°æ¨¡å‹">æœ€å°æ­¥æ•°æ¨¡å‹</h5> <p>æ­¤ç§æ¨¡å‹è¾ƒä¸ºç®€å•ï¼Œå…¶ç‰¹ç‚¹æ˜¯å›¾çš„ç»“æ„æ˜¯ç»™å®šçš„ã€ä¸ä¼šå˜åŒ–çš„ï¼Œä¸€èˆ¬ä¸ºæ£‹ç›˜æˆ–è¿·å®«ä¹‹ç±»ï¼Œæ±‚è§£å›¾ä¸Šä¸¤ç‚¹çš„æœ€å°æ­¥æ•°ï¼Œå„èŠ‚ç‚¹èƒ½é€‰æ‹©çš„åˆ†æ”¯å¾ˆå°‘ï¼Œå…¶æ„æˆçš„å›¾ä¸€å®šæ˜¯ä¸€å¼ ç¨€ç–å›¾ã€‚</p> <h5 id="æœ€å°‘è½¬æ¢æ¨¡å‹">æœ€å°‘è½¬æ¢æ¨¡å‹</h5> <p>æ­¤ç§æ¨¡å‹ä¸€å®šæ˜¯å•æºå•æ±‡é—®é¢˜ï¼Œä¹Ÿä¸€å®šæ„æˆäº†ä¸€å¼ ç¨ å¯†å›¾ã€‚ä¸€èˆ¬ç»™å®šæºç‚¹å’Œæ±‡ç‚¹çš„ç»“ç‚¹çŠ¶æ€å’Œè½¬æ¢è§„åˆ™ï¼Œæ±‚è§£æœ€å°‘è½¬æ¢çš„æ¬¡æ•°ã€‚æ¯”è¾ƒç»å…¸çš„æ¯”å¦‚8æ•°ç é—®é¢˜ã€15æ•°ç é—®é¢˜ã€‚ä¸€èˆ¬BFSæ˜¯æ±‚è§£æ­¤ç±»é—®é¢˜çš„åŸºç¡€ï¼Œä½†æ˜¯éœ€è¦ä¼˜åŒ–ã€‚ç”±äºæ¯ä¸ªèŠ‚ç‚¹å¯æ‹“å±•çš„åˆ†æ”¯æ•°ä¸€èˆ¬å¾ˆå¤šï¼Œåœ¨æœç´¢è¿‡ç¨‹ä¸­è®¿é—®çš„ç»“ç‚¹ç¨‹æŒ‡æ•°å½¢å¼å¢é•¿ï¼Œéœ€è¦ä¼˜åŒ–ã€‚</p> <h6 id="ä½¿ç”¨åŒå‘bfsç®—æ³•ä¼˜åŒ–">ä½¿ç”¨åŒå‘BFSç®—æ³•ä¼˜åŒ–</h6> <p>ä¸éš¾æƒ³è±¡ï¼Œä½¿ç”¨BFSæœç´¢ï¼Œå‡è®¾æ±‡ç‚¹åœ¨ç¬¬\(k\)å±‚ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰\(x\)ä¸ªåˆ†æ”¯ï¼Œåˆ™éœ€è¦æœç´¢\(x^k\)è¿™æ ·ä¸€ä¸ªçº§åˆ«çš„èŠ‚ç‚¹æ•°ã€‚è€Œä½¿ç”¨åŒå‘BFSç®—æ³•ï¼Œä»æºç‚¹å’Œæ±‡ç‚¹åŒæ—¶å‘ä¸­é—´çŠ¶æ€æœç´¢ï¼Œåˆ™å°†åœ¨ç¬¬\(\lfloor \frac k2\rfloor\)å±‚ç›¸é‡ï¼Œæœç´¢çš„èŠ‚ç‚¹æ•°é‡çº§ä¸º\(2\times x^{\frac k2}\)ã€‚</p> <blockquote> <p>é‡è¦çš„æŠ€å·§ï¼šæºç‚¹å’Œæ±‡ç‚¹å„ç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ¯æ¬¡åº”é€‰å–é˜Ÿåˆ—ä¸­å…ƒç´ è¾ƒå°‘çš„é‚£ä¸€æ–¹ç»§ç»­æœç´¢ï¼Œä»¥ä¿æŒä¸¤è¾¹æœç´¢çš„ç»“ç‚¹æ•°å°½é‡æ¥è¿‘ï¼Œè¾¾åˆ°ä¼˜åŒ–çš„ç›®çš„ã€‚</p> </blockquote> <h6 id="ä½¿ç”¨aç®—æ³•ä¼˜åŒ–">ä½¿ç”¨A*ç®—æ³•ä¼˜åŒ–</h6> <p>A*ç®—æ³•å¯ä»¥å®Œç¾æ±‚è§£\(k\)çŸ­è·¯é—®é¢˜(ä¸‹æ–‡è¯´åˆ°)ï¼Œæˆ‘ä»¬ä»¤\(k = 1\)åˆ™å¯ä»¥ç”¨äºä¼˜åŒ–æœ€çŸ­è·¯é—®é¢˜ã€‚ä½†ä½¿ç”¨A*ç®—æ³•ä¼˜åŒ–æœ€çŸ­è·¯é—®é¢˜å¹¶éä»…ä»…æ˜¯ä»¤\(k = 1\)ã€‚A*ç®—æ³•æ±‚è§£è¿™ä¸¤ä¸ªé—®é¢˜çš„å®é™…åº”ç”¨ä¸å°½ç›¸åŒã€‚</p> <table> <thead> <tr> <th style="text-align: right">Â </th> <th style="text-align: center">kçŸ­è·¯é—®é¢˜</th> <th style="text-align: center">ä¼˜åŒ–å•æºå•æ±‡æœ€çŸ­è·¯é—®é¢˜</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">ç€é‡ç‚¹</td> <td style="text-align: center">å°æ ¹å †ç¬¬kæ¬¡å¼¹å‡ºç¬¬kçŸ­è·¯</td> <td style="text-align: center">ä¼°ä»·å‡½æ•°ä¼˜åŒ–æœç´¢æ–¹æ¡ˆ</td> </tr> <tr> <td style="text-align: right">æ‹“å±•èŠ‚ç‚¹</td> <td style="text-align: center">æ‹“å±•æ‰€æœ‰èŠ‚ç‚¹ï¼Œå› ä¸ºåªæœ‰é‡å¤æ‹“å±•æ‰ä¼šæœ‰kçŸ­è·¯</td> <td style="text-align: center">è‹¥è¾¹æƒå”¯ä¸€ï¼ŒåŒBFSï¼›è‹¥è¾¹æƒä¸å”¯ä¸€ï¼ŒåŒDijkstra</td> </tr> <tr> <td style="text-align: right">ç»´æŠ¤è·¯å¾„</td> <td style="text-align: center">åŸºäºä¸Šé¢æ‹“å±•èŠ‚ç‚¹çš„æ–¹å¼ï¼Œä¸å¯ä»¥</td> <td style="text-align: center">åŸºäºä¸Šé¢æ‹“å±•èŠ‚ç‚¹çš„æ–¹å¼ï¼Œå¯ä»¥</td> </tr> <tr> <td style="text-align: right">ä½•æ—¶å¾—åˆ°è§£</td> <td style="text-align: center">æ±‡ç‚¹ç¬¬kæ¬¡è¢«ç”¨äºæ¢ç´¢æ—¶</td> <td style="text-align: center">è‹¥è¾¹æƒå”¯ä¸€ï¼ŒåŒBFSï¼›è‹¥è¾¹æƒä¸å”¯ä¸€ï¼ŒåŒDijkstra</td> </tr> </tbody> </table> <p>A*ç®—æ³•çš„æ•ˆç‡å–å†³äºä¼°ä»·å‡½æ•°\(g(e)\)ï¼ˆå³é¢„ä¼°èŠ‚ç‚¹\(e\)åˆ°æ±‡ç‚¹çš„è·ç¦»ï¼‰çš„å‡†ç¡®æ€§ã€‚ä¸€èˆ¬å¯ç”¨äºæœ€å°‘è½¬æ¢æ¨¡å‹ï¼ˆä½¿ç”¨è¯¥ç®—æ³•ï¼Œè½¬åŒ–æ“ä½œå¯ä»¥å¸¦æƒï¼‰å’Œæ±‚è§£ç¬¬kçŸ­è·¯ã€‚ç”¨äºæœ€å°‘è½¬åŒ–æ¨¡å‹æ—¶å¦‚æœå­˜åœ¨ç½‘æ ¼ç»“æ„ï¼Œå¯ä»¥ä»æ›¼å“ˆé¡¿è·ç¦»<sup id="fnref:m_dist" role="doc-noteref"><a href="#fn:m_dist" class="footnote">2</a></sup>çš„æ–¹å‘æ€è€ƒä¸€ä¸‹ä¼°ä»·å‡½æ•°ã€‚</p> <h3 id="å•æºæœ€çŸ­è·¯çš„å„ç§æ‹“å±•">å•æºæœ€çŸ­è·¯çš„å„ç§æ‹“å±•</h3> <h4 id="è¾¹æ•°é™åˆ¶ä¸ºkçš„æœ€çŸ­è·¯ä¸bellman-fordç®—æ³•">è¾¹æ•°é™åˆ¶ä¸ºkçš„æœ€çŸ­è·¯ä¸Bellman-Fordç®—æ³•</h4> <p>å‰æ–‡ä¸­è¯´é“Bellman-Fordç®—æ³•åœ¨åŸºç¡€æœ€çŸ­è·¯é—®é¢˜ä¸­æ²¡æœ‰ä¼˜åŠ¿ï¼Œä½†æ˜¯å…¶ä¹Ÿæœ‰ç‰¹æ®Šæ€§ï¼Œå³æ±‚è§£è¾¹æ•°é™åˆ¶ä¸º\(k\)çš„æœ€çŸ­è·¯</p> <blockquote> <p>æ—¶é—´å¤æ‚åº¦ï¼š \(O(n\cdot m)\)</p> <p>ä¸€å¥è¯æ ¸å¿ƒæ€æƒ³ï¼š\(k\)æ¬¡å¯¹æ‰€æœ‰è¾¹ä½¿ç”¨å¤‡ä»½è·ç¦»å°è¯•æ¾å¼›</p> </blockquote> \[\begin{aligned} data\ structure&amp;\\ &amp;æ•°ç»„disï¼šæºç‚¹åˆ°å„ç‚¹çš„æœ€çŸ­è·¯å¾„\\ &amp;æ•°ç»„bakï¼šæ•°ç»„disçš„å¤‡ä»½\\ initialization&amp;\\ &amp;dis(e) = \begin{cases} INF,&amp;e \not = source\\ 0,&amp;e = source \end{cases}\\ core\ algorithm&amp;\\ &amp;loop\quad k\ times\\ &amp;\hphantom{loop\quad}copy\ dis\ to\ bak\\ &amp;\hphantom{loop\quad}dis(u) = min\{ dis(u), bak(e) + d(e, u) \} \end{aligned}\] <blockquote> <p>æ³¨æ„ï¼šç”±äºåœ¨è´Ÿæƒå›¾ä¸­\(INF\)å¯ä»¥è¢«è´Ÿæƒè¾¹æ¾å¼›æˆåŠŸï¼Œæ‰€ä»¥è¦æå‰åˆ¤æ–­\(bak(e)\)ä¸æ˜¯\(INF\)ã€‚</p> </blockquote> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">type</span> <span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">SP_Bellman_Ford</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
<span class="nl">public:</span>
	<span class="k">struct</span> <span class="nc">node</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">;</span>
		<span class="n">type</span> <span class="n">len</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">ar</span><span class="p">[</span><span class="n">maxm</span><span class="p">];</span>
	<span class="n">type</span> <span class="n">INF</span> <span class="o">=</span> <span class="n">numeric_limits</span><span class="o">&lt;</span><span class="n">type</span><span class="o">&gt;::</span><span class="n">max</span><span class="p">()</span><span class="o">&gt;&gt;</span><span class="mi">1u</span><span class="p">;</span>
	<span class="n">type</span> <span class="n">dis</span><span class="p">[</span><span class="n">maxn</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">bak</span><span class="p">[</span><span class="n">maxn</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">explicit</span> <span class="n">SP_Bellman_Ford</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">m</span><span class="p">)</span> <span class="o">:</span> <span class="n">n</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">m</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="p">{}</span>
	<span class="kt">void</span> <span class="n">solve</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">source</span><span class="p">,</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">fill</span><span class="p">(</span><span class="n">dis</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dis</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">INF</span><span class="p">);</span>
		<span class="n">dis</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">;</span> <span class="n">idx</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">copy</span><span class="p">(</span><span class="n">dis</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dis</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">bak</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">bak</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">from</span><span class="p">]</span> <span class="o">!=</span> <span class="n">INF</span><span class="p">)</span>
					<span class="n">dis</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">],</span> <span class="n">bak</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">from</span><span class="p">]</span> <span class="o">+</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">len</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div> <h4 id="å¤šä¸ªå¯é€‰æºç‚¹æœ€çŸ­è·¯">å¤šä¸ªå¯é€‰æºç‚¹æœ€çŸ­è·¯</h4> <blockquote> <p>æ€è€ƒæ–¹å¼</p> </blockquote> <p>é€šè¿‡å¢åŠ ä¸€ä¸ªè™šæ‹Ÿæºç‚¹ï¼Œè§„å®šå…¶åˆ°å¯é€‰æºç‚¹è·ç¦»ä¸º\(0\)ï¼Œåˆ°å…¶ä»–èŠ‚ç‚¹è·ç¦»ä¸º\(INF\)ï¼Œä¾¿è½¬åŒ–ä¸ºæ™®é€šçš„å•æºæœ€çŸ­è·¯</p> <blockquote> <p>ç¼–ç æ–¹æ³•</p> </blockquote> <p>å°†æœ¬æ¥ä½œç”¨äºå•ä¸ªæºç‚¹çš„åˆå§‹åŒ–ä½œç”¨äºæ‰€æœ‰å¯é€‰æºç‚¹å³å¯</p> <h4 id="æ­£æƒå›¾ä¸Šçš„æ¬¡çŸ­è·¯ä¸dijkstraç®—æ³•">æ­£æƒå›¾ä¸Šçš„æ¬¡çŸ­è·¯ä¸Dijkstraç®—æ³•</h4> <p>å°†\(visã€dis\)ç»´æŠ¤ä¸¤ç»„å³å¯ï¼Œæ¾å¼›çš„æ—¶å€™è®¨è®ºå½“å‰çš„è·¯å°äºæœ€çŸ­è·¯ï¼Œæˆ–è€…å¤§äºæœ€çŸ­è·¯ä½†å°äºæ¬¡çŸ­è·¯è¿™ä¸¤ç§æƒ…å†µï¼Œå°±èƒ½ç»´æŠ¤ä¸€ä¸ªæ¬¡çŸ­è·¯äº†ã€‚</p> <p>ç†è®ºä¸Šä»»ä½•ç¬¬\(k\)ï¼ˆç¡®å®šå€¼ï¼‰çŸ­è·¯éƒ½å¯ä»¥ç”¨æ­¤æ–¹æ³•æ±‚è§£ï¼Œä½†å¹¶ä¸å®ç”¨ã€‚</p> <h4 id="kçŸ­è·¯ä¸aç®—æ³•">kçŸ­è·¯ä¸A*ç®—æ³•</h4> <p>A*ç®—æ³•ä¸Šæ–‡è®¨è®ºè¿‡ï¼Œè¿™é‡Œç»™å‡ºä½¿ç”¨A*æ±‚è§£kçŸ­è·¯é—®é¢˜çš„è¯¦ç»†ç®—æ³•æ€æƒ³ã€‚</p> <blockquote> <p>A*ç®—æ³•ä¿è¯æ­£ç¡®æ€§çš„å‰æï¼šå¯¹äºä»»æ„èŠ‚ç‚¹ï¼Œä¼°ä»·å‡½æ•°ä¸å¤§äºå®é™…å€¼ã€‚</p> <p>ä½¿ç”¨A*æœç´¢æ—¶ä½¿ç”¨å°æ ¹å †ç»´æŠ¤èŠ‚ç‚¹ï¼ˆå¯¹äºèŠ‚ç‚¹\(e\)ï¼Œç»´æŠ¤ä¿¡æ¯ä¸º\(\{g(e) + dis(e), \{ dis(e), e \}\}\)ï¼Œå…¶ä¸­\(dis(e)\)ä¸éœ€è¦é¢å¤–ç»´æŠ¤ï¼‰ã€‚</p> </blockquote> \[\begin{aligned} DATA&amp;\\ &amp;ä¼°ä»·å‡½æ•°ge: å„ç‚¹åˆ°æ±‡ç‚¹çš„è·ç¦»ä¼°ä»·(ä¸å¤§äºå®é™…è·ç¦»)\\ &amp;å°æ ¹å †srp:\ &lt;g(e) + dis(e), &lt;dis(e), e&gt;&gt;\\ INIT&amp;\\ &amp;æ ¹æ®æ›¼å“ˆé¡¿è·ç¦»æˆ–åå‘æœ€çŸ­è·¯æ„é€ ä¼°ä»·å‡½æ•°ge\\ &amp;push\ source\ to\ srp\\ CORE&amp;\\ &amp;cnt = 0\\ &amp;\!\begin{aligned} loop\quad&amp;until\ srp\ is\ empty\\ &amp;pop\ cur\ from\ srp\\ &amp;\!\begin{aligned} if\quad&amp;cur == sink\mbox{ &amp;&amp; }+\!\!+cnt == k\\ &amp;return\quad dis(cur) \end{aligned}\\ &amp;\forall u\in\{ cur's\ successors \}\\ &amp;\quad\quad push\ \{ g(u) + dis(cur) + d(cur, u), \{ dis(cur) + d(cur, u), u \} \}\ into\ srp \end{aligned} \end{aligned}\] <h4 id="ç»´æŠ¤è·¯å¾„æœ€çŸ­è·¯">ç»´æŠ¤è·¯å¾„æœ€çŸ­è·¯</h4> <p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ç»´æŠ¤æ‰¾åˆ°çš„æœ€çŸ­è·¯çš„è·¯å¾„ã€‚ä¹Ÿå¾ˆç®€å•ï¼Œåªè¦è®°å½•æ¯ä¸ªèŠ‚ç‚¹æ˜¯å¦‚ä½•è¢«æœç´¢åˆ°çš„ï¼ˆæ¯”å¦‚ç”±å“ªä¸ªèŠ‚ç‚¹æ‹“å±•è€Œæ¥ã€æœ‰å“ªä¸ªæ–¹å‘æœç´¢å¾—åˆ°ç­‰ç­‰ï¼‰ï¼Œåªè¦æ ¹æ®è®°å½•å¯ä»¥ä»æ±‡ç‚¹åæ¨å¾—åˆ°è·¯å¾„å°±OKã€‚</p> <blockquote> <p>Tips: å¯ä»¥ç›´æ¥åœ¨åå‘å›¾ä¸Šæ‰§è¡Œç®—æ³•ï¼Œé‚£ä¹ˆå°±æ— éœ€åæ¨äº†â€”â€”åå‘å›¾çš„é€†å‘è·¯å¾„å³æ­£å‘å›¾çš„æ­£å‘è·¯å¾„ã€‚</p> </blockquote> <h5 id="æœ€å°å­—å…¸åºè·¯å¾„">æœ€å°å­—å…¸åºè·¯å¾„</h5> <p>æ—¢ç„¶è¦æ±‚è§£æœ€å°å­—å…¸åºçš„æœ€çŸ­è·¯å¾„ï¼Œå°±ä¸€å®šå­˜åœ¨è¯„åˆ¤å¤§å°çš„æ ‡å‡†ï¼Œåœ¨æ‰§è¡Œç®—æ³•æ—¶æŒ‰ç…§çº¦å®šé¡ºåºæ‹“å±•å³å¯ã€‚</p> <h5 id="æ‰€æœ‰è·¯å¾„">æ‰€æœ‰è·¯å¾„</h5> <p>å…ˆä½¿ç”¨æœ€çŸ­è·¯ç®—æ³•å¾—åˆ°æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚ç„¶åä½¿ç”¨dfså¾—åˆ°æ‰€æœ‰æœ€çŸ­è·¯ï¼Œå¦‚æœè¦æ±‚é¡ºåºï¼Œdfsçš„è¿‡ç¨‹éµå®ˆçº¦å®šé¡ºåºå³å¯ã€‚</p> <h2 id="å…¶ä»–">å…¶ä»–</h2> <h3 id="spfaç®—æ³•ä¸åˆ¤æ–­è´Ÿç¯">SPFAç®—æ³•ä¸åˆ¤æ–­è´Ÿç¯</h3> <p>å’Œæœ€çŸ­è·¯é—®é¢˜ç»å¸¸ä¸€åŒå‡ºç°çš„å¯¹è´Ÿæƒå›¾çš„åˆ¤æ–­è´Ÿç¯ï¼ŒBellman-Fordç®—æ³•å’ŒSPFAç®—æ³•éƒ½å¯ä»¥æ±‚è§£ï¼Œå› ä¸ºSPFAç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¼˜ç§€ï¼Œæ•…ä½¿ç”¨SPFAç®—æ³•æ±‚è§£ã€‚</p> <blockquote> <p>å¦‚ä½•æ±‚è§£ï¼Ÿ</p> </blockquote> <p>æ ¹æ®æŠ½å±‰åŸç†ï¼Œå¯¹äºä¸€å¼ æœ‰\(n\)ä¸ªèŠ‚ç‚¹çš„å›¾ï¼Œè‹¥ä¸€æ¡æœ€çŸ­è·¯ä¸Šæœ‰\(n\)æ¡è¾¹ï¼Œå³\(n + 1\)ä¸ªèŠ‚ç‚¹ï¼Œåˆ™è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹å‡ºç°æ¬¡æ•°ä¸å°äº2æ¬¡ï¼Œå³å‡ºç°äº†è´Ÿç¯ã€‚</p> \[\begin{aligned} data\ structure&amp;\\ &amp;æ•°ç»„disï¼šæºç‚¹åˆ°å„ç‚¹çš„æœ€çŸ­è·¯å¾„(åœ¨åˆ¤æ–­è´Ÿç¯æ—¶ï¼Œæ­¤æ„ä¹‰ä¸é‡è¦)\\ &amp;æ•°ç»„cntï¼šæºç‚¹åˆ°å„ç‚¹çš„æœ€çŸ­è·¯å¾„è¾¹æ•°\\ &amp;é›†åˆvisï¼šæ»¡è¶³çŠ¶æ€ã€Œè¢«æ¾å¼›æˆåŠŸä½†å°šæœªå‘åè¿›è¡Œæ¾å¼›æ“ä½œã€çš„ç»“ç‚¹çš„é›†åˆ\\ &amp;é˜Ÿåˆ—queï¼š&lt;e&gt;, e\in Vertex\\ initialization&amp;\\ &amp;\forall e\in Vertex,cnt(e) = 0\\ &amp;ä¿è¯è¯¥å›¾çš„æ‰€æœ‰è”é€šå­å›¾è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹æ”¾å…¥vis\\ &amp;æ”¾å…¥visçš„ç»“ç‚¹åŒæ ·éœ€è¦æ”¾å…¥que\\ core\ algorithm&amp;\\ &amp;loop\quad untill\ que\ is\ empty\\ &amp;\hphantom{loop\quad}pop\ cur\ from\ que\\ &amp;\hphantom{loop\quad}delete\ cur\ from\ vis\\ &amp;\hphantom{loop\quad}if\quad relax(cur, u),u\in \{ u's\ successors \}\ is\ successful\\ &amp;\hphantom{loop\quad if\quad}cnt(u) = cnt(e) + 1\\ &amp;\hphantom{loop\quad if\quad}if\quad cnt(u)\ equals\ the\ size\ of\ Vertexs\\ &amp;\hphantom{loop\quad if\quad if\quad}å­˜åœ¨è´Ÿç¯\\ &amp;\hphantom{loop\quad if\quad}if\quad u\not\in vis\\ &amp;\hphantom{loop\quad if\quad if\quad}push\ u\ in\ vis\\ &amp;\hphantom{loop\quad if\quad if\quad}push\ u\ in\ que\\ &amp;è‹¥ç®—æ³•æ‰§è¡Œç»“æŸæœªå‘ç°è´Ÿç¯åˆ™ä¸å­˜åœ¨ \end{aligned}\] <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">type</span> <span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">SP</span> <span class="p">{</span>
	<span class="k">const</span> <span class="n">type</span> <span class="n">INF</span> <span class="o">=</span> <span class="n">numeric_limits</span><span class="o">&lt;</span> <span class="n">type</span> <span class="o">&gt;::</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="mi">1u</span><span class="p">;</span>
	<span class="n">type</span> <span class="n">dis</span><span class="p">[</span><span class="n">maxn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="kt">bool</span> <span class="n">vis</span><span class="p">[</span><span class="n">maxn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">[</span><span class="n">maxn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
	<span class="n">queue</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">que</span><span class="p">;</span>
<span class="nl">public:</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">to</span><span class="p">,</span> <span class="n">ptr</span><span class="p">;</span>
		<span class="n">type</span> <span class="n">len</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">ar</span><span class="p">[</span><span class="n">maxm</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="kt">int</span> <span class="n">head</span><span class="p">[</span><span class="n">maxn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">{};</span>
	<span class="k">explicit</span> <span class="n">SP</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span> <span class="n">n</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{}</span>
	<span class="kt">bool</span> <span class="n">solve</span><span class="p">()</span> <span class="p">{</span>
		<span class="n">fill</span><span class="p">(</span><span class="n">vis</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">vis</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
		<span class="n">fill</span><span class="p">(</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cnt</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">fill</span><span class="p">(</span><span class="n">dis</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dis</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">INF</span><span class="p">);</span>	<span class="c1">// åˆå§‹åŒ–ä¸ºINFæœ‰åˆ©äºé˜²æ­¢æº¢å‡º</span>
		<span class="n">queue</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span><span class="p">().</span><span class="n">swap</span><span class="p">(</span><span class="n">que</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">que</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
		<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">que</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
			<span class="k">static</span> <span class="kt">int</span> <span class="n">cur</span><span class="p">;</span>
			<span class="n">cur</span> <span class="o">=</span> <span class="n">que</span><span class="p">.</span><span class="n">front</span><span class="p">(),</span> <span class="n">que</span><span class="p">.</span><span class="n">pop</span><span class="p">(),</span> <span class="n">vis</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">cur</span><span class="p">];</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ptr</span><span class="p">)</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span> <span class="o">+</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">len</span> <span class="o">&lt;</span> <span class="n">dis</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">])</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">((</span><span class="n">cnt</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnt</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
					<span class="n">dis</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">]</span> <span class="o">=</span> <span class="n">dis</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span> <span class="o">+</span> <span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">len</span><span class="p">;</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">])</span> <span class="p">{</span>
						<span class="n">que</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">);</span>
						<span class="n">vis</span><span class="p">[</span><span class="n">ar</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:link_astar" role="doc-endnote"> <p>ä¸€ç§ä½¿ç”¨æ•°ç»„æ¨¡æ‹Ÿé“¾è¡¨çš„ç»“æ„ï¼Œæœ¬åšå®¢ä¼šåœ¨åé¢æ•°æ®ç»“æ„çš„ä¸“é¢˜æ–‡ç« ä¸­è¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚Â <a href="#fnref:link_astar" class="reversefootnote" role="doc-backlink">â†©</a></p> </li> <li id="fn:m_dist" role="doc-endnote"> <p>åœ¨æ¬§å‡ é‡Œå¾—ç©ºé—´çš„å›ºå®šç›´è§’åæ ‡ç³»ä¸Šä¸¤ç‚¹æ‰€å½¢æˆçš„çº¿æ®µå¯¹è½´äº§ç”Ÿçš„æŠ•å½±çš„è·ç¦»æ€»å’Œ.Â <a href="#fnref:m_dist" class="reversefootnote" role="doc-backlink">â†©</a></p> </li> </ol> </div> </div> </div> </div> </div> </div> <footer> <div class="container"> <div class="row"> <div class="col-lg-8"> <p>Mooyyu Crab.'s Blog <i class="fa fa-heart text-danger" aria-hidden="true"></i>. Check out <a href="//github.com/mooyyu/mooyyu.github.io" target="_blank">Github Project <i class="fa fa-github-alt" aria-hidden="true"></i></a>.<br> The contents of this website are Â© 2021 under the terms of the <a href="//www.gnu.org/licenses/gpl-3.0.txt" target="_blank">GPLv3</a> License.</p> </div> <div class="col-lg-4"> <div class="pull-right"> <a href="#top" data-proofer-ignore> Back to top <i class="fa fa-level-up" aria-hidden="true"></i></a> </div> </div> </div> </div> </footer> <div style="width: 100%; overflow-x: hidden;"> <canvas class="fireworks" style="position:fixed;left:0;top:0;z-index:99999999;pointer-events:none;"></canvas> </div> <script>
  MathJax = {
    options: {
      enableMenu: false
    }
  };
</script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-svg.js"></script> <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-128176907-1', {
          'cookieDomain': 'mooyyu.github.io',
          'siteSpeedSampleRate': 80
      });

      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script> </body> </html>
